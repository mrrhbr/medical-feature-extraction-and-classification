{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"gpuType":"T4"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"5ed0d1e08db4433c8bd8978c216baf02":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_cad78858fbe64bff87bb785d393fca56","IPY_MODEL_36c25e5569144fe9a5f49ad4ceafb433","IPY_MODEL_4d1114e6c89547a59bd710913698ced5"],"layout":"IPY_MODEL_62a75cac82b64f838888425140d497ec"}},"cad78858fbe64bff87bb785d393fca56":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_c63de1333cdd499182198a1401950aa8","placeholder":"​","style":"IPY_MODEL_5a06b7d3f5444ab1a5df0f7aade4db60","value":"Map: 100%"}},"36c25e5569144fe9a5f49ad4ceafb433":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_c04be9594c9f45bfaf6fd9e1c34c01f6","max":7364,"min":0,"orientation":"horizontal","style":"IPY_MODEL_aca3ab17d5c549bdb86b659bdd7c782f","value":7364}},"4d1114e6c89547a59bd710913698ced5":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a6b282ed454a4a79b06c3ba37366c034","placeholder":"​","style":"IPY_MODEL_15c1b3f1dbaa4733a4ac88e25a39fb70","value":" 7364/7364 [00:01&lt;00:00, 5444.87 examples/s]"}},"62a75cac82b64f838888425140d497ec":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"c63de1333cdd499182198a1401950aa8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5a06b7d3f5444ab1a5df0f7aade4db60":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"c04be9594c9f45bfaf6fd9e1c34c01f6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"aca3ab17d5c549bdb86b659bdd7c782f":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"a6b282ed454a4a79b06c3ba37366c034":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"15c1b3f1dbaa4733a4ac88e25a39fb70":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"b640deb1f6804f408222b7058a335fc2":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_d5ba0b2e62de40f69f5f077df78ea413","IPY_MODEL_927577ed307f451e8fff0a8e92974ec1","IPY_MODEL_81a2d1d4393744b0beab04fdd5dbd181"],"layout":"IPY_MODEL_6bc01794b7924e1186f5842759928914"}},"d5ba0b2e62de40f69f5f077df78ea413":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_87a84f46da38432c942623f26decf1df","placeholder":"​","style":"IPY_MODEL_0db4b5898a5649959a03ec7846c14fd5","value":"Map: 100%"}},"927577ed307f451e8fff0a8e92974ec1":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_3792d3e605da40ac9758d8c160fa5618","max":1841,"min":0,"orientation":"horizontal","style":"IPY_MODEL_5123b539c37c4a939da2cc427cf70cfb","value":1841}},"81a2d1d4393744b0beab04fdd5dbd181":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_8a6a7517ed8541efb0fb00e61089d227","placeholder":"​","style":"IPY_MODEL_f57c0dc75a7a47d8a2eea445026ca507","value":" 1841/1841 [00:00&lt;00:00, 4120.94 examples/s]"}},"6bc01794b7924e1186f5842759928914":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"87a84f46da38432c942623f26decf1df":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0db4b5898a5649959a03ec7846c14fd5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"3792d3e605da40ac9758d8c160fa5618":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"5123b539c37c4a939da2cc427cf70cfb":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"8a6a7517ed8541efb0fb00e61089d227":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"f57c0dc75a7a47d8a2eea445026ca507":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ff3297f7d80b4c1d9b8171db00bb9618":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_64db82acf1384537adcfe8fa88a068b1","IPY_MODEL_6c8710e0ca684fe09c8abe105f2580d1","IPY_MODEL_390a83a19d4049889fa9ef6b14a2ba8d"],"layout":"IPY_MODEL_b7ac055189de4e4597a48e1e9ce05928"}},"64db82acf1384537adcfe8fa88a068b1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0ce1bfa870c94aaa936429a03a686f36","placeholder":"​","style":"IPY_MODEL_23896c05e551402787edc58408944ec7","value":"vocab.txt: 100%"}},"6c8710e0ca684fe09c8abe105f2580d1":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_929ba9d50885422abfbaba6d4d25f515","max":1198122,"min":0,"orientation":"horizontal","style":"IPY_MODEL_33ae02d2ce4d47fea6331a759dc7fad7","value":1198122}},"390a83a19d4049889fa9ef6b14a2ba8d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_453e7ed86a7741ccb9e03df27a1ff0df","placeholder":"​","style":"IPY_MODEL_558f6842f6674266aa02466847c543b2","value":" 1.20M/1.20M [00:00&lt;00:00, 4.80MB/s]"}},"b7ac055189de4e4597a48e1e9ce05928":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0ce1bfa870c94aaa936429a03a686f36":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"23896c05e551402787edc58408944ec7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"929ba9d50885422abfbaba6d4d25f515":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"33ae02d2ce4d47fea6331a759dc7fad7":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"453e7ed86a7741ccb9e03df27a1ff0df":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"558f6842f6674266aa02466847c543b2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ec961aeddcf74cccb2fd4bebed3c4461":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_8ba81eddf5f5457089ba8464ecabe2cd","IPY_MODEL_213a9aa14e344381aa79d55bd7070073","IPY_MODEL_51ec8d3021bd44d6ae5405a7542c75b9"],"layout":"IPY_MODEL_b843bb51c24f4a7db26ec22071e22c11"}},"8ba81eddf5f5457089ba8464ecabe2cd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_434d9bf3988840e5987b7ddf154e0184","placeholder":"​","style":"IPY_MODEL_ddc8e330126c4eaeb7fa0da98e1ca791","value":"config.json: 100%"}},"213a9aa14e344381aa79d55bd7070073":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_872922a065b04533b50ab831115ba69d","max":440,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ea240d251bb3453690418383a1700202","value":440}},"51ec8d3021bd44d6ae5405a7542c75b9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_86c20147735a400e8b94013092cf5b5f","placeholder":"​","style":"IPY_MODEL_3590db4cae0f4172abb3a8190c3e02d2","value":" 440/440 [00:00&lt;00:00, 34.8kB/s]"}},"b843bb51c24f4a7db26ec22071e22c11":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"434d9bf3988840e5987b7ddf154e0184":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ddc8e330126c4eaeb7fa0da98e1ca791":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"872922a065b04533b50ab831115ba69d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ea240d251bb3453690418383a1700202":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"86c20147735a400e8b94013092cf5b5f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"3590db4cae0f4172abb3a8190c3e02d2":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ea1ecff259344a05adbc2970c2173155":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_1f37dbe3137a4c408b74de9ae88b4790","IPY_MODEL_d30e2f47071440babeb903188d35b6eb","IPY_MODEL_eb1eca4c2ec94bd3890b225816134bdb"],"layout":"IPY_MODEL_9b5a2d891ffe43fbaa924b3cb7f8deb1"}},"1f37dbe3137a4c408b74de9ae88b4790":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_0adac590d313459683350d147cd49247","placeholder":"​","style":"IPY_MODEL_7b1670505f594c13bec269b4a59ca254","value":"pytorch_model.bin: 100%"}},"d30e2f47071440babeb903188d35b6eb":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_d8bcd300b0834dff97d22b6400137dc7","max":654226731,"min":0,"orientation":"horizontal","style":"IPY_MODEL_bfae00d27285496d8389da9649b55e22","value":654226731}},"eb1eca4c2ec94bd3890b225816134bdb":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e0f65beeab7640a2a0d765e135ea60a5","placeholder":"​","style":"IPY_MODEL_45e41c89b2bc428185d239456c4bd4b7","value":" 654M/654M [00:04&lt;00:00, 244MB/s]"}},"9b5a2d891ffe43fbaa924b3cb7f8deb1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0adac590d313459683350d147cd49247":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7b1670505f594c13bec269b4a59ca254":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"d8bcd300b0834dff97d22b6400137dc7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"bfae00d27285496d8389da9649b55e22":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"e0f65beeab7640a2a0d765e135ea60a5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"45e41c89b2bc428185d239456c4bd4b7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","source":["!pip install datasets"],"metadata":{"id":"PY2j1s_UQy0G","executionInfo":{"status":"ok","timestamp":1724528570903,"user_tz":-210,"elapsed":3001,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"554c23a1-47b1-4ac6-e0c4-dded4b1d9f20"},"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: datasets in /usr/local/lib/python3.10/dist-packages (2.21.0)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from datasets) (3.15.4)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.10/dist-packages (from datasets) (1.26.4)\n","Requirement already satisfied: pyarrow>=15.0.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (17.0.0)\n","Requirement already satisfied: dill<0.3.9,>=0.3.0 in /usr/local/lib/python3.10/dist-packages (from datasets) (0.3.8)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.10/dist-packages (from datasets) (2.1.4)\n","Requirement already satisfied: requests>=2.32.2 in /usr/local/lib/python3.10/dist-packages (from datasets) (2.32.3)\n","Requirement already satisfied: tqdm>=4.66.3 in /usr/local/lib/python3.10/dist-packages (from datasets) (4.66.5)\n","Requirement already satisfied: xxhash in /usr/local/lib/python3.10/dist-packages (from datasets) (3.5.0)\n","Requirement already satisfied: multiprocess in /usr/local/lib/python3.10/dist-packages (from datasets) (0.70.16)\n","Requirement already satisfied: fsspec<=2024.6.1,>=2023.1.0 in /usr/local/lib/python3.10/dist-packages (from fsspec[http]<=2024.6.1,>=2023.1.0->datasets) (2024.6.1)\n","Requirement already satisfied: aiohttp in /usr/local/lib/python3.10/dist-packages (from datasets) (3.10.5)\n","Requirement already satisfied: huggingface-hub>=0.21.2 in /usr/local/lib/python3.10/dist-packages (from datasets) (0.23.5)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from datasets) (24.1)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.10/dist-packages (from datasets) (6.0.2)\n","Requirement already satisfied: aiohappyeyeballs>=2.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (2.4.0)\n","Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (1.3.1)\n","Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (24.2.0)\n","Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (1.4.1)\n","Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (6.0.5)\n","Requirement already satisfied: yarl<2.0,>=1.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (1.9.4)\n","Requirement already satisfied: async-timeout<5.0,>=4.0 in /usr/local/lib/python3.10/dist-packages (from aiohttp->datasets) (4.0.3)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.10/dist-packages (from huggingface-hub>=0.21.2->datasets) (4.12.2)\n","Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests>=2.32.2->datasets) (3.3.2)\n","Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.32.2->datasets) (3.7)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.32.2->datasets) (2.0.7)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.32.2->datasets) (2024.7.4)\n","Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2.8.2)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2024.1)\n","Requirement already satisfied: tzdata>=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas->datasets) (2024.1)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil>=2.8.2->pandas->datasets) (1.16.0)\n"]}]},{"cell_type":"code","source":["import os\n","os.environ['CUDA_LAUNCH_BLOCKING'] = '1'\n","os.environ['TORCH_USE_CUDA_DSA'] = '1'\n"],"metadata":{"id":"0L7AGVeGAjE1","executionInfo":{"status":"ok","timestamp":1724528570903,"user_tz":-210,"elapsed":2,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":2,"outputs":[]},{"cell_type":"code","execution_count":3,"metadata":{"id":"_cDg0JFCQDrI","executionInfo":{"status":"ok","timestamp":1724528573585,"user_tz":-210,"elapsed":2683,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"outputs":[],"source":["import pandas as pd\n","import torch\n","from datasets import Dataset\n","from torch.utils.data import DataLoader, SequentialSampler\n","import ast\n","import re\n","import numpy as np\n","from transformers import BertTokenizer\n","from tqdm import tqdm\n","from sklearn.metrics import accuracy_score"]},{"cell_type":"code","source":["# Set device to GPU if available, otherwise use CPU\n","device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n","\n","print(f\"Using device: {device}\")\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"e9uVD7yV8O4I","executionInfo":{"status":"ok","timestamp":1724528573585,"user_tz":-210,"elapsed":3,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}},"outputId":"16a81faf-43c4-43e9-c29e-32377a60ddb1"},"execution_count":4,"outputs":[{"output_type":"stream","name":"stdout","text":["Using device: cuda\n"]}]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"QdlX0k2tQ9Ab","executionInfo":{"status":"ok","timestamp":1724528576558,"user_tz":-210,"elapsed":2975,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}},"outputId":"4168e67b-ec2c-4b4b-c8c9-30c72715198e"},"execution_count":5,"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}]},{"cell_type":"code","source":["file_path = '/content/drive/MyDrive/Error_d/data.csv'\n","df = pd.read_csv(file_path)"],"metadata":{"id":"vBoq4acURG2U","executionInfo":{"status":"ok","timestamp":1724528576558,"user_tz":-210,"elapsed":5,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":6,"outputs":[]},{"cell_type":"code","source":["columns_to_drop_without_nationality = ['USER_NUMBER', 'file_name','begin','end','Gender','wrong_word','process','main_category','sub_category_1','sub_category_2','Training Center','Nationality','nationality_encoded','correct_word','word_tokens_correct','correct_sentence','word_tokens_wrong']\n","columns_to_drop_with_nationality =  ['USER_NUMBER','file_name', 'begin','end','Gender','wrong_word','process','main_category','sub_category_1','sub_category_2','Training Center','correct_word','word_tokens_correct','correct_sentence','word_tokens_wrong']\n","\n","tdwn = df.drop(columns=columns_to_drop_without_nationality)\n","td= df.drop(columns=columns_to_drop_with_nationality)\n","# Training_df_with_nationality =df.drop(columns=columns_to_drop_with_nationality)"],"metadata":{"id":"8ZjNsXJsRPcS","executionInfo":{"status":"ok","timestamp":1724528576559,"user_tz":-210,"elapsed":6,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":7,"outputs":[]},{"cell_type":"code","source":["td"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"21szWZW8y9ON","executionInfo":{"status":"ok","timestamp":1724528576559,"user_tz":-210,"elapsed":6,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}},"outputId":"0e7129c4-07fa-4fb8-cd0c-a2dd3cb87982"},"execution_count":8,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                         wrong_sentence  \\\n","0     افغانستان\\n \\n موضوع : اسراف\\n \\n اسراف را خدا...   \n","1     افغانستان\\n \\n موضوع : اسراف\\n \\n اسراف را خدا...   \n","2     افغانستان\\n \\n موضوع : اسراف\\n \\n اسراف را خدا...   \n","3     افغانستان\\n \\n موضوع : اسراف\\n \\n اسراف را خدا...   \n","4     افغانستان\\n \\n موضوع : اسراف\\n \\n اسراف را خدا...   \n","...                                                 ...   \n","9202  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9203  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9204  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9205  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9206                 من و علی سیرو سیاه را دوست داریم .   \n","\n","                                            error_index Nationality  \\\n","0     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   افغانستان   \n","1     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...   افغانستان   \n","2     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   افغانستان   \n","3     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 31, 31, 0, 0...   افغانستان   \n","4     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...   افغانستان   \n","...                                                 ...         ...   \n","9202  [0, 0, 0, 0, 40, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...         NaN   \n","9203  [0, 0, 0, 0, 0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0,...         NaN   \n","9204  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 0, 0,...         NaN   \n","9205  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...         NaN   \n","9206                       [0, 0, 0, 0, 12, 0, 0, 0, 0]         NaN   \n","\n","      nationality_encoded  \n","0                       1  \n","1                       1  \n","2                       1  \n","3                       1  \n","4                       1  \n","...                   ...  \n","9202                    0  \n","9203                    0  \n","9204                    0  \n","9205                    0  \n","9206                    0  \n","\n","[9207 rows x 4 columns]"],"text/html":["\n","  <div id=\"df-0edd5513-f6de-476c-b076-d71205f8b706\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>wrong_sentence</th>\n","      <th>error_index</th>\n","      <th>Nationality</th>\n","      <th>nationality_encoded</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>افغانستان\\n \\n موضوع : اسراف\\n \\n اسراف را خدا...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>افغانستان</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>افغانستان\\n \\n موضوع : اسراف\\n \\n اسراف را خدا...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...</td>\n","      <td>افغانستان</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>افغانستان\\n \\n موضوع : اسراف\\n \\n اسراف را خدا...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>افغانستان</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>افغانستان\\n \\n موضوع : اسراف\\n \\n اسراف را خدا...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 31, 31, 0, 0...</td>\n","      <td>افغانستان</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>افغانستان\\n \\n موضوع : اسراف\\n \\n اسراف را خدا...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...</td>\n","      <td>افغانستان</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>9202</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 40, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...</td>\n","      <td>NaN</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>9203</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0,...</td>\n","      <td>NaN</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>9204</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 0, 0,...</td>\n","      <td>NaN</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>9205</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>NaN</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>9206</th>\n","      <td>من و علی سیرو سیاه را دوست داریم .</td>\n","      <td>[0, 0, 0, 0, 12, 0, 0, 0, 0]</td>\n","      <td>NaN</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>9207 rows × 4 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-0edd5513-f6de-476c-b076-d71205f8b706')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-0edd5513-f6de-476c-b076-d71205f8b706 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-0edd5513-f6de-476c-b076-d71205f8b706');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-3628f621-ac1a-4887-8812-6145314ffe26\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-3628f621-ac1a-4887-8812-6145314ffe26')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-3628f621-ac1a-4887-8812-6145314ffe26 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"td","summary":"{\n  \"name\": \"td\",\n  \"rows\": 9207,\n  \"fields\": [\n    {\n      \"column\": \"wrong_sentence\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 3438,\n        \"samples\": [\n          \"\\u0633\\u0627\\u0639\\u062a \\u062f\\u0648 \\u062a\\u0627 \\u0633\\u0627\\u0639\\u062a \\u0633\\u0647 \\u0646\\u0642\\u0627\\u0634\\u0647 \\u0645\\u06cc \\u06a9\\u0634\\u0645 \\u0648 \\u0633\\u0627\\u0639\\u062a \\u0633\\u0647 \\u0648 \\u0646\\u06cc\\u0645 \\u062a\\u0627 \\u0633\\u0627\\u0639\\u062a \\u0634\\u0634 \\u0645\\u0646 \\u062a\\u06a9\\u0644\\u06cc\\u0641 \\u0645\\u06cc \\u0646\\u0648\\u06cc\\u0633\\u0645 \\u0648 \\u0645\\u0637\\u0644\\u0639\\u0647 \\u0645\\u06cc \\u06a9\\u0646\\u0645 .\",\n          \"\\u0641\\u0635\\u0644 \\u0628\\u0647\\u0627\\u0631 3 \\u0645\\u0627\\u0647 \\u062f\\u0627\\u0631\\u062f \\u060c \\u0627\\u0633\\u0645 \\u0647\\u0627\\u06cc\\u0634\\u0627\\u0646 \\u0641\\u0631\\u0648\\u0631\\u062f\\u06cc\\u0646 \\u060c \\u0627\\u0648\\u062f\\u06cc\\u0628\\u0647\\u0634\\u062a \\u060c \\u062e\\u0631\\u062f\\u0627\\u062f\\n \\n \\u0641\\u0635\\u0644 \\u0628\\u0647\\u0627\\u0631 \\u0627\\u0648\\u0651\\u0644 \\u0645\\u0627\\u0647 \\u0627\\u0633\\u062a .\",\n          \"\\u0646\\u0648\\u06cc\\u0633\\u0646\\u062f\\u06c0 \\u0631\\u0648\\u0632\\u0646\\u0627\\u0645\\u0647 \\u0646\\u0648\\u0634\\u062a \\u06a9\\u0647 \\u0627\\u0631\\u062f\\u0648\\u063a\\u0627\\u0646 \\u0648 \\u062d\\u06a9\\u0648\\u0645\\u062a\\u0634 \\u062d\\u0627\\u0644\\u0627 \\u0628\\u0627\\u06cc\\u062f \\u062a\\u0641\\u06a9\\u0631\\u0634\\u0627\\u0646 \\u0639\\u0648\\u0636 \\u06a9\\u0646\\u0646\\u062f \\u062a\\u0627 \\u0627\\u06cc\\u0646\\u06a9\\u0647 \\u0628\\u062a\\u0648\\u0627\\u0646\\u0646\\u062f \\u06af\\u0641\\u062a\\u06af\\u0648 \\u0627\\u06cc \\u0628\\u0627 \\u062d\\u0632\\u0628 \\u0647 .\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"error_index\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 5074,\n        \"samples\": [\n          \"[31, 31, 31, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]\",\n          \"[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]\",\n          \"[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40, 40, 40, 0, 0, 0, 0, 0, 0]\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Nationality\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 78,\n        \"samples\": [\n          \"\\u0627\\u06cc\\u062a\\u0627\\u0644\\u06cc\\u0627\",\n          \"\\u0627\\u0641\\u063a\\u0627\\u0646\\u0633\\u062a\\u0627\\u0646\",\n          \"\\u0633\\u0627\\u062d\\u0644 \\u0639\\u0627\\u062c\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"nationality_encoded\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 20,\n        \"min\": 0,\n        \"max\": 78,\n        \"num_unique_values\": 79,\n        \"samples\": [\n          31,\n          1,\n          23\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":8}]},{"cell_type":"code","source":["tokenizer = BertTokenizer.from_pretrained('HooshvareLab/bert-base-parsbert-uncased')"],"metadata":{"id":"Qqf-QVKipgs6","executionInfo":{"status":"ok","timestamp":1724528578318,"user_tz":-210,"elapsed":1763,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}},"colab":{"base_uri":"https://localhost:8080/"},"outputId":"8592f453-81b8-4a17-8166-453f5470fba2"},"execution_count":9,"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/huggingface_hub/utils/_token.py:89: UserWarning: \n","The secret `HF_TOKEN` does not exist in your Colab secrets.\n","To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.\n","You will be able to reuse this secret in all of your notebooks.\n","Please note that authentication is recommended but still optional to access public models or datasets.\n","  warnings.warn(\n"]}]},{"cell_type":"code","source":["def clean_string(text, symbols):\n","    \"\"\"\n","    Clean tokens in a string.\n","\n","    Args:\n","    - text (str): The text to process.\n","    - symbols (list): List of symbols to remove from tokens.\n","\n","    Returns:\n","    - str: The cleaned string.\n","    \"\"\"\n","    # Split the text into tokens (this might need adjustment based on your tokenization)\n","    tokens = text.split()  # Adjust if your tokenization is different\n","\n","    # Clean each token\n","    cleaned_tokens = clean_list(tokens, symbols)\n","\n","    # Combine cleaned tokens back into a single string\n","    cleaned_text = ' '.join(cleaned_tokens)\n","\n","    return cleaned_text"],"metadata":{"id":"rXZSvCj1DR_H","executionInfo":{"status":"ok","timestamp":1724528578318,"user_tz":-210,"elapsed":3,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":10,"outputs":[]},{"cell_type":"code","source":["def clean_token(token, symbols):\n","    \"\"\"\n","    Clean a single token based on given symbols.\n","\n","    Args:\n","    - token (str): The token to clean.\n","    - symbols (list): List of symbols to be removed.\n","\n","    Returns:\n","    - str: The cleaned token.\n","    \"\"\"\n","    for symbol in symbols:\n","        token = token.replace(symbol, '')\n","    return token.strip()\n","\n","def clean_list(token_list, symbols):\n","    \"\"\"\n","    Clean a list of tokens using the clean_token function.\n","\n","    Args:\n","    - token_list (list): List of tokens to clean.\n","    - symbols (list): List of symbols to remove from tokens.\n","\n","    Returns:\n","    - list: The cleaned list of tokens.\n","    \"\"\"\n","    return [clean_token(token, symbols) for token in token_list]\n","\n","def clean_string(text, symbols):\n","    \"\"\"\n","    Clean tokens in a string.\n","\n","    Args:\n","    - text (str): The text to process.\n","    - symbols (list): List of symbols to remove from tokens.\n","\n","    Returns:\n","    - str: The cleaned string.\n","    \"\"\"\n","    if isinstance(text, str):\n","        # Split the text into tokens (this might need adjustment based on your tokenization)\n","        tokens = text.split()  # Adjust if your tokenization is different\n","\n","        # Clean each token\n","        cleaned_tokens = clean_list(tokens, symbols)\n","\n","        # Combine cleaned tokens back into a single string\n","        cleaned_text = ' '.join(cleaned_tokens)\n","\n","        return cleaned_text\n","    else:\n","        return text  # Return the input as is if it's not a string\n","\n"],"metadata":{"id":"8pYTN4jnDmBY","executionInfo":{"status":"ok","timestamp":1724528578318,"user_tz":-210,"elapsed":3,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":11,"outputs":[]},{"cell_type":"code","source":["symbols = [\n","    '@', '#', '$', '%', '^', '&', '*', '(', ')', '[', ']', '{', '}', '\"',\n","    '*\\r', '+', ',', 'ø', '>>', 'CV', 'EXPO', 'None', 'alfare', 'fat', '«',\n","    '\\\\u200', '\\\\u200c', '\\\\u200f', '\\\\u200e', '\\r','\\u200c'\n","]"],"metadata":{"id":"5hEgsResR6Aw","executionInfo":{"status":"ok","timestamp":1724528578318,"user_tz":-210,"elapsed":2,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":12,"outputs":[]},{"cell_type":"code","source":["tdwn['wrong_sentence'] = tdwn['wrong_sentence'].apply(lambda x: clean_string(x, symbols))\n"],"metadata":{"id":"fuzCwDIDIYPp","executionInfo":{"status":"ok","timestamp":1724528580756,"user_tz":-210,"elapsed":2440,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":13,"outputs":[]},{"cell_type":"code","source":["td['wrong_sentence'] = td['wrong_sentence'].apply(lambda x: clean_string(x, symbols))\n"],"metadata":{"id":"y79KDnegJ5Il","executionInfo":{"status":"ok","timestamp":1724528582456,"user_tz":-210,"elapsed":1702,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":14,"outputs":[]},{"cell_type":"code","source":["td"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"jsNYbiS4k9oL","executionInfo":{"status":"ok","timestamp":1724528582457,"user_tz":-210,"elapsed":5,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}},"outputId":"ec92c199-8b75-4314-ba50-f2c4e7147197"},"execution_count":15,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                         wrong_sentence  \\\n","0     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","1     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","2     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","3     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","4     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","...                                                 ...   \n","9202  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9203  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9204  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9205  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9206                 من و علی سیرو سیاه را دوست داریم .   \n","\n","                                            error_index Nationality  \\\n","0     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   افغانستان   \n","1     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...   افغانستان   \n","2     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   افغانستان   \n","3     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 31, 31, 0, 0...   افغانستان   \n","4     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...   افغانستان   \n","...                                                 ...         ...   \n","9202  [0, 0, 0, 0, 40, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...         NaN   \n","9203  [0, 0, 0, 0, 0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0,...         NaN   \n","9204  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 0, 0,...         NaN   \n","9205  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...         NaN   \n","9206                       [0, 0, 0, 0, 12, 0, 0, 0, 0]         NaN   \n","\n","      nationality_encoded  \n","0                       1  \n","1                       1  \n","2                       1  \n","3                       1  \n","4                       1  \n","...                   ...  \n","9202                    0  \n","9203                    0  \n","9204                    0  \n","9205                    0  \n","9206                    0  \n","\n","[9207 rows x 4 columns]"],"text/html":["\n","  <div id=\"df-d9e48593-4848-4545-bf8e-aa2a39592aeb\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>wrong_sentence</th>\n","      <th>error_index</th>\n","      <th>Nationality</th>\n","      <th>nationality_encoded</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>افغانستان</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...</td>\n","      <td>افغانستان</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>افغانستان</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 31, 31, 0, 0...</td>\n","      <td>افغانستان</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...</td>\n","      <td>افغانستان</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>9202</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 40, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...</td>\n","      <td>NaN</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>9203</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0,...</td>\n","      <td>NaN</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>9204</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 0, 0,...</td>\n","      <td>NaN</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>9205</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>NaN</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>9206</th>\n","      <td>من و علی سیرو سیاه را دوست داریم .</td>\n","      <td>[0, 0, 0, 0, 12, 0, 0, 0, 0]</td>\n","      <td>NaN</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>9207 rows × 4 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-d9e48593-4848-4545-bf8e-aa2a39592aeb')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-d9e48593-4848-4545-bf8e-aa2a39592aeb button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-d9e48593-4848-4545-bf8e-aa2a39592aeb');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-feddb761-d460-4c9e-8381-224cf5381f43\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-feddb761-d460-4c9e-8381-224cf5381f43')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-feddb761-d460-4c9e-8381-224cf5381f43 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"td","summary":"{\n  \"name\": \"td\",\n  \"rows\": 9207,\n  \"fields\": [\n    {\n      \"column\": \"wrong_sentence\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 3434,\n        \"samples\": [\n          \"\\u0628\\u063a\\u0636\\u06cc \\u0648\\u0642\\u062a \\u0647\\u0627 \\u0631\\u0648\\u0632 \\u062c\\u0645\\u0639\\u0647 \\u0628\\u0627 \\u0647\\u0645\\u0633\\u0631\\u0645 \\u0628\\u0631\\u0627\\u06cc \\u06af\\u0631\\u062f\\u0634 \\u0648 \\u0632\\u06cc\\u0627\\u0631\\u062a \\u0645\\u06cc \\u0631\\u0648\\u06cc\\u0645 .\",\n          \"\\u062f\\u0631 \\u06af\\u0634\\u0648\\u0631 \\u0645\\u0627 \\u062e\\u06cc\\u0644\\u06cc \\u0627\\u0646\\u0648\\u0627\\u0621 \\u0645\\u0631\\u062f\\u0645 \\u062f\\u0627\\u0631\\u062f .\",\n          \"\\u062f\\u0646\\u062f\\u0627\\u0646 \\u0645\\u0633\\u0648\\u0627\\u06af \\u0628\\u0631\\u0627\\u06cc \\u0630\\u0646\\u062f\\u0627\\u0646 \\u0627\\u0633\\u062a\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"error_index\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 5074,\n        \"samples\": [\n          \"[31, 31, 31, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]\",\n          \"[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 31, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]\",\n          \"[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40, 40, 40, 0, 0, 0, 0, 0, 0]\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Nationality\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 78,\n        \"samples\": [\n          \"\\u0627\\u06cc\\u062a\\u0627\\u0644\\u06cc\\u0627\",\n          \"\\u0627\\u0641\\u063a\\u0627\\u0646\\u0633\\u062a\\u0627\\u0646\",\n          \"\\u0633\\u0627\\u062d\\u0644 \\u0639\\u0627\\u062c\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"nationality_encoded\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 20,\n        \"min\": 0,\n        \"max\": 78,\n        \"num_unique_values\": 79,\n        \"samples\": [\n          31,\n          1,\n          23\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":15}]},{"cell_type":"code","source":["tdwn = tdwn.dropna(how='any')\n","td = td.dropna(how='any')"],"metadata":{"id":"M56K0xDKaTRE","executionInfo":{"status":"ok","timestamp":1724528582457,"user_tz":-210,"elapsed":4,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":16,"outputs":[]},{"cell_type":"code","source":["def tokenize_and_pad(sentence, tokenizer, max_length=209):\n","    if not isinstance(sentence, str):  # Handle non-string entries\n","        return {\n","            'input_ids': [-1] * max_length,  # Return a padding-only sequence if not a valid string\n","            'attention_mask': [0] * max_length  # All zeros for attention mask\n","        }\n","\n","    encoded = tokenizer(\n","        sentence,\n","        padding='max_length',  # Pad to max_length\n","        truncation=True,       # Truncate to max_length\n","        max_length=max_length, # Ensure all sequences are of length max_length\n","        return_tensors='pt'    # Return PyTorch tensors\n","    )\n","\n","    return {\n","        'input_ids': encoded['input_ids'].squeeze().tolist(),  # Convert to a list of token IDs\n","        'attention_mask': encoded['attention_mask'].squeeze().tolist()  # Convert to a list of attention mask values\n","    }\n"],"metadata":{"id":"grG1EeF7sOCU","executionInfo":{"status":"ok","timestamp":1724528582457,"user_tz":-210,"elapsed":4,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":17,"outputs":[]},{"cell_type":"code","source":["# Apply the function to each row and split the results into two columns\n","tdwn[['input_ids', 'attention_mask']] = tdwn['wrong_sentence'].apply(\n","    lambda x: pd.Series(tokenize_and_pad(x, tokenizer))\n",")\n"],"metadata":{"id":"xB-N_2RTow6_","executionInfo":{"status":"ok","timestamp":1724528596095,"user_tz":-210,"elapsed":13641,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}},"collapsed":true},"execution_count":18,"outputs":[]},{"cell_type":"code","source":["tdwn"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":597},"id":"sMx1FvPYR8MV","executionInfo":{"status":"ok","timestamp":1724528596096,"user_tz":-210,"elapsed":7,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}},"outputId":"4ebf7f1a-b526-41d4-8768-5332278d80db"},"execution_count":19,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                         wrong_sentence  \\\n","0     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","1     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","2     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","3     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","4     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","...                                                 ...   \n","9202  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9203  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9204  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9205  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9206                 من و علی سیرو سیاه را دوست داریم .   \n","\n","                                            error_index  \\\n","0     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   \n","1     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...   \n","2     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   \n","3     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 31, 31, 0, 0...   \n","4     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...   \n","...                                                 ...   \n","9202  [0, 0, 0, 0, 40, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...   \n","9203  [0, 0, 0, 0, 0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0,...   \n","9204  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 0, 0,...   \n","9205  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   \n","9206                       [0, 0, 0, 0, 12, 0, 0, 0, 0]   \n","\n","                                              input_ids  \\\n","0     [2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...   \n","1     [2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...   \n","2     [2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...   \n","3     [2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...   \n","4     [2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...   \n","...                                                 ...   \n","9202  [2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...   \n","9203  [2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...   \n","9204  [2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...   \n","9205  [2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...   \n","9206  [2, 2078, 331, 2547, 51019, 4910, 2049, 3584, ...   \n","\n","                                         attention_mask  \n","0     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...  \n","1     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...  \n","2     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...  \n","3     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...  \n","4     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...  \n","...                                                 ...  \n","9202  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...  \n","9203  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...  \n","9204  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...  \n","9205  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...  \n","9206  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, ...  \n","\n","[9205 rows x 4 columns]"],"text/html":["\n","  <div id=\"df-28dcd7ba-f5aa-471b-ae8d-db9c112b51a7\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>wrong_sentence</th>\n","      <th>error_index</th>\n","      <th>input_ids</th>\n","      <th>attention_mask</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>[2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...</td>\n","      <td>[2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>[2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 31, 31, 0, 0...</td>\n","      <td>[2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...</td>\n","      <td>[2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>9202</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 40, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...</td>\n","      <td>[2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","    </tr>\n","    <tr>\n","      <th>9203</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0,...</td>\n","      <td>[2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","    </tr>\n","    <tr>\n","      <th>9204</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 0, 0,...</td>\n","      <td>[2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","    </tr>\n","    <tr>\n","      <th>9205</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>[2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","    </tr>\n","    <tr>\n","      <th>9206</th>\n","      <td>من و علی سیرو سیاه را دوست داریم .</td>\n","      <td>[0, 0, 0, 0, 12, 0, 0, 0, 0]</td>\n","      <td>[2, 2078, 331, 2547, 51019, 4910, 2049, 3584, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, ...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>9205 rows × 4 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-28dcd7ba-f5aa-471b-ae8d-db9c112b51a7')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-28dcd7ba-f5aa-471b-ae8d-db9c112b51a7 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-28dcd7ba-f5aa-471b-ae8d-db9c112b51a7');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-196896eb-dea8-49f7-87b3-c2b0423acda3\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-196896eb-dea8-49f7-87b3-c2b0423acda3')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-196896eb-dea8-49f7-87b3-c2b0423acda3 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"tdwn","summary":"{\n  \"name\": \"tdwn\",\n  \"rows\": 9205,\n  \"fields\": [\n    {\n      \"column\": \"wrong_sentence\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 3434,\n        \"samples\": [\n          \"\\u0628\\u063a\\u0636\\u06cc \\u0648\\u0642\\u062a \\u0647\\u0627 \\u0631\\u0648\\u0632 \\u062c\\u0645\\u0639\\u0647 \\u0628\\u0627 \\u0647\\u0645\\u0633\\u0631\\u0645 \\u0628\\u0631\\u0627\\u06cc \\u06af\\u0631\\u062f\\u0634 \\u0648 \\u0632\\u06cc\\u0627\\u0631\\u062a \\u0645\\u06cc \\u0631\\u0648\\u06cc\\u0645 .\",\n          \"\\u062f\\u0631 \\u06af\\u0634\\u0648\\u0631 \\u0645\\u0627 \\u062e\\u06cc\\u0644\\u06cc \\u0627\\u0646\\u0648\\u0627\\u0621 \\u0645\\u0631\\u062f\\u0645 \\u062f\\u0627\\u0631\\u062f .\",\n          \"\\u062f\\u0646\\u062f\\u0627\\u0646 \\u0645\\u0633\\u0648\\u0627\\u06af \\u0628\\u0631\\u0627\\u06cc \\u0630\\u0646\\u062f\\u0627\\u0646 \\u0627\\u0633\\u062a\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"error_index\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 5073,\n        \"samples\": [\n          \"[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0]\",\n          \"[0, 0, 0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 0]\",\n          \"[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40, 40, 40, 0, 0, 0, 0, 0, 0]\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"input_ids\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"attention_mask\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":19}]},{"cell_type":"code","source":["def tokenize_and_pad_Nationality(sentence, tokenizer, max_length=10):\n","    if not isinstance(sentence, str):  # Handle non-string entries\n","        return {\n","            'input_ids': [0] * max_length,  # Return a padding-only sequence if not a valid string\n","            'attention_mask': [0] * max_length  # All zeros for attention mask\n","        }\n","\n","    encoded = tokenizer(\n","        sentence,\n","        padding='max_length',  # Pad to max_length\n","        truncation=True,       # Truncate to max_length\n","        max_length=max_length, # Ensure all sequences are of length max_length\n","        return_tensors='pt'    # Return PyTorch tensors\n","    )\n","\n","    return {\n","        'input_ids': encoded['input_ids'].squeeze().tolist(),  # Convert to a list of token IDs\n","        'attention_mask': encoded['attention_mask'].squeeze().tolist()  # Convert to a list of attention mask values\n","    }"],"metadata":{"id":"MjDmBtQ2OOjh","executionInfo":{"status":"ok","timestamp":1724528596096,"user_tz":-210,"elapsed":4,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":20,"outputs":[]},{"cell_type":"code","source":["td[['Nationality_encode', 'attention_mask_n']] = td['Nationality'].apply(\n","    lambda x: pd.Series(tokenize_and_pad_Nationality(x, tokenizer))\n",")"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"collapsed":true,"id":"q2LD1UsHKJiz","executionInfo":{"status":"ok","timestamp":1724528600450,"user_tz":-210,"elapsed":4358,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}},"outputId":"44e967b5-5211-4dbf-b92a-b50355844834"},"execution_count":21,"outputs":[{"output_type":"stream","name":"stderr","text":["<ipython-input-21-cb9b468bcd21>:1: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  td[['Nationality_encode', 'attention_mask_n']] = td['Nationality'].apply(\n","<ipython-input-21-cb9b468bcd21>:1: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  td[['Nationality_encode', 'attention_mask_n']] = td['Nationality'].apply(\n"]}]},{"cell_type":"code","source":["td"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":597},"id":"Q8qaTmrUPY2B","executionInfo":{"status":"ok","timestamp":1724528600450,"user_tz":-210,"elapsed":5,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}},"outputId":"83fc93ab-500b-4e9c-f3c6-8be3b49511b8"},"execution_count":22,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                         wrong_sentence  \\\n","0     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","1     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","2     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","3     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","4     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","...                                                 ...   \n","9090            آیا این زرّبین . است ، نه آن دوربین است   \n","9091                                و علی قران می خواند   \n","9092                                و علی قران می خواند   \n","9093                                              ظوقال   \n","9094                                              ظوقال   \n","\n","                                            error_index Nationality  \\\n","0     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   افغانستان   \n","1     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...   افغانستان   \n","2     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   افغانستان   \n","3     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 31, 31, 0, 0...   افغانستان   \n","4     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...   افغانستان   \n","...                                                 ...         ...   \n","9090                    [0, 0, 12, 0, 0, 0, 0, 0, 0, 0]         یمن   \n","9091                                  [0, 0, 0, 40, 40]         یمن   \n","9092                                   [0, 0, 25, 0, 0]         یمن   \n","9093                                               [13]         یمن   \n","9094                                               [12]         یمن   \n","\n","      nationality_encoded                 Nationality_encode  \\\n","0                       1  [2, 4981, 4, 0, 0, 0, 0, 0, 0, 0]   \n","1                       1  [2, 4981, 4, 0, 0, 0, 0, 0, 0, 0]   \n","2                       1  [2, 4981, 4, 0, 0, 0, 0, 0, 0, 0]   \n","3                       1  [2, 4981, 4, 0, 0, 0, 0, 0, 0, 0]   \n","4                       1  [2, 4981, 4, 0, 0, 0, 0, 0, 0, 0]   \n","...                   ...                                ...   \n","9090                   78  [2, 5246, 4, 0, 0, 0, 0, 0, 0, 0]   \n","9091                   78  [2, 5246, 4, 0, 0, 0, 0, 0, 0, 0]   \n","9092                   78  [2, 5246, 4, 0, 0, 0, 0, 0, 0, 0]   \n","9093                   78  [2, 5246, 4, 0, 0, 0, 0, 0, 0, 0]   \n","9094                   78  [2, 5246, 4, 0, 0, 0, 0, 0, 0, 0]   \n","\n","                    attention_mask_n  \n","0     [1, 1, 1, 0, 0, 0, 0, 0, 0, 0]  \n","1     [1, 1, 1, 0, 0, 0, 0, 0, 0, 0]  \n","2     [1, 1, 1, 0, 0, 0, 0, 0, 0, 0]  \n","3     [1, 1, 1, 0, 0, 0, 0, 0, 0, 0]  \n","4     [1, 1, 1, 0, 0, 0, 0, 0, 0, 0]  \n","...                              ...  \n","9090  [1, 1, 1, 0, 0, 0, 0, 0, 0, 0]  \n","9091  [1, 1, 1, 0, 0, 0, 0, 0, 0, 0]  \n","9092  [1, 1, 1, 0, 0, 0, 0, 0, 0, 0]  \n","9093  [1, 1, 1, 0, 0, 0, 0, 0, 0, 0]  \n","9094  [1, 1, 1, 0, 0, 0, 0, 0, 0, 0]  \n","\n","[9093 rows x 6 columns]"],"text/html":["\n","  <div id=\"df-7ce3efb6-f812-43bd-8ca2-41ff67c179f8\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>wrong_sentence</th>\n","      <th>error_index</th>\n","      <th>Nationality</th>\n","      <th>nationality_encoded</th>\n","      <th>Nationality_encode</th>\n","      <th>attention_mask_n</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>افغانستان</td>\n","      <td>1</td>\n","      <td>[2, 4981, 4, 0, 0, 0, 0, 0, 0, 0]</td>\n","      <td>[1, 1, 1, 0, 0, 0, 0, 0, 0, 0]</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...</td>\n","      <td>افغانستان</td>\n","      <td>1</td>\n","      <td>[2, 4981, 4, 0, 0, 0, 0, 0, 0, 0]</td>\n","      <td>[1, 1, 1, 0, 0, 0, 0, 0, 0, 0]</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>افغانستان</td>\n","      <td>1</td>\n","      <td>[2, 4981, 4, 0, 0, 0, 0, 0, 0, 0]</td>\n","      <td>[1, 1, 1, 0, 0, 0, 0, 0, 0, 0]</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 31, 31, 0, 0...</td>\n","      <td>افغانستان</td>\n","      <td>1</td>\n","      <td>[2, 4981, 4, 0, 0, 0, 0, 0, 0, 0]</td>\n","      <td>[1, 1, 1, 0, 0, 0, 0, 0, 0, 0]</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...</td>\n","      <td>افغانستان</td>\n","      <td>1</td>\n","      <td>[2, 4981, 4, 0, 0, 0, 0, 0, 0, 0]</td>\n","      <td>[1, 1, 1, 0, 0, 0, 0, 0, 0, 0]</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>9090</th>\n","      <td>آیا این زرّبین . است ، نه آن دوربین است</td>\n","      <td>[0, 0, 12, 0, 0, 0, 0, 0, 0, 0]</td>\n","      <td>یمن</td>\n","      <td>78</td>\n","      <td>[2, 5246, 4, 0, 0, 0, 0, 0, 0, 0]</td>\n","      <td>[1, 1, 1, 0, 0, 0, 0, 0, 0, 0]</td>\n","    </tr>\n","    <tr>\n","      <th>9091</th>\n","      <td>و علی قران می خواند</td>\n","      <td>[0, 0, 0, 40, 40]</td>\n","      <td>یمن</td>\n","      <td>78</td>\n","      <td>[2, 5246, 4, 0, 0, 0, 0, 0, 0, 0]</td>\n","      <td>[1, 1, 1, 0, 0, 0, 0, 0, 0, 0]</td>\n","    </tr>\n","    <tr>\n","      <th>9092</th>\n","      <td>و علی قران می خواند</td>\n","      <td>[0, 0, 25, 0, 0]</td>\n","      <td>یمن</td>\n","      <td>78</td>\n","      <td>[2, 5246, 4, 0, 0, 0, 0, 0, 0, 0]</td>\n","      <td>[1, 1, 1, 0, 0, 0, 0, 0, 0, 0]</td>\n","    </tr>\n","    <tr>\n","      <th>9093</th>\n","      <td>ظوقال</td>\n","      <td>[13]</td>\n","      <td>یمن</td>\n","      <td>78</td>\n","      <td>[2, 5246, 4, 0, 0, 0, 0, 0, 0, 0]</td>\n","      <td>[1, 1, 1, 0, 0, 0, 0, 0, 0, 0]</td>\n","    </tr>\n","    <tr>\n","      <th>9094</th>\n","      <td>ظوقال</td>\n","      <td>[12]</td>\n","      <td>یمن</td>\n","      <td>78</td>\n","      <td>[2, 5246, 4, 0, 0, 0, 0, 0, 0, 0]</td>\n","      <td>[1, 1, 1, 0, 0, 0, 0, 0, 0, 0]</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>9093 rows × 6 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-7ce3efb6-f812-43bd-8ca2-41ff67c179f8')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-7ce3efb6-f812-43bd-8ca2-41ff67c179f8 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-7ce3efb6-f812-43bd-8ca2-41ff67c179f8');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-b65ecb96-e061-4535-b15d-ffd53ef905e0\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-b65ecb96-e061-4535-b15d-ffd53ef905e0')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-b65ecb96-e061-4535-b15d-ffd53ef905e0 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"td","summary":"{\n  \"name\": \"td\",\n  \"rows\": 9093,\n  \"fields\": [\n    {\n      \"column\": \"wrong_sentence\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 3390,\n        \"samples\": [\n          \"\\u0628\\u0631\\u0627\\u06cc \\u0645\\u0631\\u062f\\u0645 \\u060c \\u06a9\\u0647 \\u062f\\u06cc\\u0646 \\u0627\\u06cc\\u0634\\u0648\\u0646 \\u0628\\u0627 \\u062f\\u06cc\\u0646 \\u0622\\u0646 \\u06a9\\u0634\\u0648\\u0631 \\u0641\\u0631\\u0642\\u06cc \\u062f\\u0627\\u0631\\u062f \\u060c \\u06a9\\u0645\\u06cc \\u0633\\u062d\\u062a \\u0627\\u0633\\u062a .\",\n          \"\\u062f\\u0631 \\u062e\\u0644\\u0627\\u0635\\u0647 \\u060c \\u0645\\u06cc\\u062a\\u0648\\u0627\\u0646\\u06cc\\u0645 \\u0628\\u06af\\u0648\\u06cc\\u06cc\\u0645 \\u06a9\\u0647 \\u0647\\u0631 \\u062f\\u0648 \\u0646\\u0648\\u0639 \\u06a9\\u062a\\u0627\\u0628 \\u0648\\u06cc\\u0698\\u06af\\u06cc\\u0647\\u0627\\u06cc \\u062e\\u0648\\u0628 \\u0648 \\u0628\\u062f \\u062f\\u0627\\u0631\\u062f \\u0628\\u0647 \\u0646\\u0638\\u0631 \\u0645\\u0646 \\u060c \\u062e\\u0648\\u0627\\u0646\\u062f\\u0646 \\u06a9\\u062a\\u0627\\u0628 \\u06a9\\u0627\\u063a\\u0630\\u06cc \\u062c\\u0630\\u0627\\u0628\\u06cc\\u062a \\u0628\\u06cc\\u0634\\u062a\\u0631 \\u062f\\u0627\\u0631\\u062f .\",\n          \"\\u0686\\u0627\\u0631\\u0648 \\u060c \\u062a\\u0644\\u0641\\u0646 \\u060c\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"error_index\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 5022,\n        \"samples\": [\n          \"[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 31, 31, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]\",\n          \"[0, 0, 0, 0, 0, 0, 40, 0, 0, 0, 0, 0, 0]\",\n          \"[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 40, 40, 0, 0, 0, 0, 0, 40, 40, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Nationality\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 78,\n        \"samples\": [\n          \"\\u0627\\u06cc\\u062a\\u0627\\u0644\\u06cc\\u0627\",\n          \"\\u0627\\u0641\\u063a\\u0627\\u0646\\u0633\\u062a\\u0627\\u0646\",\n          \"\\u0633\\u0627\\u062d\\u0644 \\u0639\\u0627\\u062c\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"nationality_encoded\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 20,\n        \"min\": 1,\n        \"max\": 78,\n        \"num_unique_values\": 78,\n        \"samples\": [\n          34,\n          1,\n          35\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"Nationality_encode\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"attention_mask_n\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":22}]},{"cell_type":"code","source":["td[['input_ids', 'attention_mask']] = td['wrong_sentence'].apply(\n","    lambda x: pd.Series(tokenize_and_pad(x, tokenizer))\n",")"],"metadata":{"id":"CEFQSUE-LHql","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1724528614191,"user_tz":-210,"elapsed":13745,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}},"outputId":"3b52aaf2-2d88-4023-da98-7a8a566d829f"},"execution_count":23,"outputs":[{"output_type":"stream","name":"stderr","text":["<ipython-input-23-8542f4410b5d>:1: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  td[['input_ids', 'attention_mask']] = td['wrong_sentence'].apply(\n","<ipython-input-23-8542f4410b5d>:1: SettingWithCopyWarning: \n","A value is trying to be set on a copy of a slice from a DataFrame.\n","Try using .loc[row_indexer,col_indexer] = value instead\n","\n","See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n","  td[['input_ids', 'attention_mask']] = td['wrong_sentence'].apply(\n"]}]},{"cell_type":"code","source":["# td[['input_ids']] = td['wrong_sentence'].apply(\n","#     lambda x: pd.Series(tokenize_and_pad(x, tokenizer))\n","# )"],"metadata":{"id":"3k5FdfmBLQiy","executionInfo":{"status":"ok","timestamp":1724528614191,"user_tz":-210,"elapsed":13,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":24,"outputs":[]},{"cell_type":"code","source":["# torch.cuda.empty_cache()"],"metadata":{"id":"HGoUWDSNJWNn","executionInfo":{"status":"ok","timestamp":1724528614191,"user_tz":-210,"elapsed":13,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":25,"outputs":[]},{"cell_type":"code","source":["def pad_sequence(sequence, max_length=209, pad_value=0):\n","    # Ensure the sequence is not longer than max_length\n","    sequence = sequence[:max_length]\n","    return sequence + [pad_value] * (max_length - len(sequence))\n"],"metadata":{"id":"nN8m2Q7yUKtU","executionInfo":{"status":"ok","timestamp":1724528614191,"user_tz":-210,"elapsed":12,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":26,"outputs":[]},{"cell_type":"code","source":["# Function to safely convert string to list\n","def safe_eval(value):\n","    import ast\n","    try:\n","        return ast.literal_eval(value)\n","    except:\n","        return []\n","\n","# Convert string representation to actual list\n","tdwn['error_index'] = tdwn['error_index'].apply(safe_eval)\n","\n"],"metadata":{"id":"t7KT6pjBUM8R","executionInfo":{"status":"ok","timestamp":1724528614900,"user_tz":-210,"elapsed":721,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":27,"outputs":[]},{"cell_type":"code","source":["tdwn['error_index'] = tdwn['error_index'].apply(lambda x: pad_sequence(x, pad_value=0))"],"metadata":{"id":"JNT2lHIjUVaN","executionInfo":{"status":"ok","timestamp":1724528614900,"user_tz":-210,"elapsed":8,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":28,"outputs":[]},{"cell_type":"code","source":["tdwn"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":597},"id":"qYphgjjzU4_P","executionInfo":{"status":"ok","timestamp":1724528614900,"user_tz":-210,"elapsed":7,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}},"outputId":"713baf83-0c8d-4ea2-c51d-0092971fbbb0"},"execution_count":29,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                         wrong_sentence  \\\n","0     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","1     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","2     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","3     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","4     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","...                                                 ...   \n","9202  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9203  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9204  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9205  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9206                 من و علی سیرو سیاه را دوست داریم .   \n","\n","                                            error_index  \\\n","0     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   \n","1     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...   \n","2     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   \n","3     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 31, 31, 0, 0...   \n","4     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...   \n","...                                                 ...   \n","9202  [0, 0, 0, 0, 40, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...   \n","9203  [0, 0, 0, 0, 0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0,...   \n","9204  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 0, 0,...   \n","9205  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   \n","9206  [0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...   \n","\n","                                              input_ids  \\\n","0     [2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...   \n","1     [2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...   \n","2     [2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...   \n","3     [2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...   \n","4     [2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...   \n","...                                                 ...   \n","9202  [2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...   \n","9203  [2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...   \n","9204  [2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...   \n","9205  [2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...   \n","9206  [2, 2078, 331, 2547, 51019, 4910, 2049, 3584, ...   \n","\n","                                         attention_mask  \n","0     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...  \n","1     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...  \n","2     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...  \n","3     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...  \n","4     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...  \n","...                                                 ...  \n","9202  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...  \n","9203  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...  \n","9204  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...  \n","9205  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...  \n","9206  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, ...  \n","\n","[9205 rows x 4 columns]"],"text/html":["\n","  <div id=\"df-807b2400-4939-45fa-bd64-8b62822575a8\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>wrong_sentence</th>\n","      <th>error_index</th>\n","      <th>input_ids</th>\n","      <th>attention_mask</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>[2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...</td>\n","      <td>[2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>[2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 31, 31, 0, 0...</td>\n","      <td>[2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...</td>\n","      <td>[2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>9202</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 40, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...</td>\n","      <td>[2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","    </tr>\n","    <tr>\n","      <th>9203</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0,...</td>\n","      <td>[2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","    </tr>\n","    <tr>\n","      <th>9204</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 0, 0,...</td>\n","      <td>[2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","    </tr>\n","    <tr>\n","      <th>9205</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>[2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","    </tr>\n","    <tr>\n","      <th>9206</th>\n","      <td>من و علی سیرو سیاه را دوست داریم .</td>\n","      <td>[0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...</td>\n","      <td>[2, 2078, 331, 2547, 51019, 4910, 2049, 3584, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, ...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>9205 rows × 4 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-807b2400-4939-45fa-bd64-8b62822575a8')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-807b2400-4939-45fa-bd64-8b62822575a8 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-807b2400-4939-45fa-bd64-8b62822575a8');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-15bf11e7-a1f8-48f0-85ff-d48a8e8045fc\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-15bf11e7-a1f8-48f0-85ff-d48a8e8045fc')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-15bf11e7-a1f8-48f0-85ff-d48a8e8045fc button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"tdwn","summary":"{\n  \"name\": \"tdwn\",\n  \"rows\": 9205,\n  \"fields\": [\n    {\n      \"column\": \"wrong_sentence\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 3434,\n        \"samples\": [\n          \"\\u0628\\u063a\\u0636\\u06cc \\u0648\\u0642\\u062a \\u0647\\u0627 \\u0631\\u0648\\u0632 \\u062c\\u0645\\u0639\\u0647 \\u0628\\u0627 \\u0647\\u0645\\u0633\\u0631\\u0645 \\u0628\\u0631\\u0627\\u06cc \\u06af\\u0631\\u062f\\u0634 \\u0648 \\u0632\\u06cc\\u0627\\u0631\\u062a \\u0645\\u06cc \\u0631\\u0648\\u06cc\\u0645 .\",\n          \"\\u062f\\u0631 \\u06af\\u0634\\u0648\\u0631 \\u0645\\u0627 \\u062e\\u06cc\\u0644\\u06cc \\u0627\\u0646\\u0648\\u0627\\u0621 \\u0645\\u0631\\u062f\\u0645 \\u062f\\u0627\\u0631\\u062f .\",\n          \"\\u062f\\u0646\\u062f\\u0627\\u0646 \\u0645\\u0633\\u0648\\u0627\\u06af \\u0628\\u0631\\u0627\\u06cc \\u0630\\u0646\\u062f\\u0627\\u0646 \\u0627\\u0633\\u062a\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"error_index\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"input_ids\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"attention_mask\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":29}]},{"cell_type":"code","source":[],"metadata":{"id":"TOv6WaYnssEO","executionInfo":{"status":"ok","timestamp":1724528614900,"user_tz":-210,"elapsed":6,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":29,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"y6MK-GfdtTWh","executionInfo":{"status":"ok","timestamp":1724528614900,"user_tz":-210,"elapsed":6,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":29,"outputs":[]},{"cell_type":"code","source":["# Create a new column 'error_index_length' to store the length of each list in 'error_index'\n","tdwn['error_index_length'] = tdwn['input_ids'].apply(lambda x: len(x) if isinstance(x, list) else 0)\n"],"metadata":{"id":"viZqVdPwV9bo","executionInfo":{"status":"ok","timestamp":1724528614900,"user_tz":-210,"elapsed":6,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":30,"outputs":[]},{"cell_type":"code","source":["tdwn"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":597},"id":"QE76VPR0swMg","executionInfo":{"status":"ok","timestamp":1724528614900,"user_tz":-210,"elapsed":6,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}},"outputId":"cee71a65-a9e4-49fa-c5cb-01cc65447988"},"execution_count":31,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                         wrong_sentence  \\\n","0     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","1     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","2     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","3     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","4     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","...                                                 ...   \n","9202  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9203  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9204  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9205  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9206                 من و علی سیرو سیاه را دوست داریم .   \n","\n","                                            error_index  \\\n","0     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   \n","1     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...   \n","2     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   \n","3     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 31, 31, 0, 0...   \n","4     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...   \n","...                                                 ...   \n","9202  [0, 0, 0, 0, 40, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...   \n","9203  [0, 0, 0, 0, 0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0,...   \n","9204  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 0, 0,...   \n","9205  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   \n","9206  [0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...   \n","\n","                                              input_ids  \\\n","0     [2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...   \n","1     [2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...   \n","2     [2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...   \n","3     [2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...   \n","4     [2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...   \n","...                                                 ...   \n","9202  [2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...   \n","9203  [2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...   \n","9204  [2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...   \n","9205  [2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...   \n","9206  [2, 2078, 331, 2547, 51019, 4910, 2049, 3584, ...   \n","\n","                                         attention_mask  error_index_length  \n","0     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...                 209  \n","1     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...                 209  \n","2     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...                 209  \n","3     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...                 209  \n","4     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...                 209  \n","...                                                 ...                 ...  \n","9202  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...                 209  \n","9203  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...                 209  \n","9204  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...                 209  \n","9205  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...                 209  \n","9206  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, ...                 209  \n","\n","[9205 rows x 5 columns]"],"text/html":["\n","  <div id=\"df-6830bd47-ef92-4e10-af97-156958116314\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>wrong_sentence</th>\n","      <th>error_index</th>\n","      <th>input_ids</th>\n","      <th>attention_mask</th>\n","      <th>error_index_length</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>[2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","      <td>209</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...</td>\n","      <td>[2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","      <td>209</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>[2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","      <td>209</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 31, 31, 0, 0...</td>\n","      <td>[2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","      <td>209</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12, 12, 0, 0...</td>\n","      <td>[2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","      <td>209</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>9202</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 40, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...</td>\n","      <td>[2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","      <td>209</td>\n","    </tr>\n","    <tr>\n","      <th>9203</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0,...</td>\n","      <td>[2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","      <td>209</td>\n","    </tr>\n","    <tr>\n","      <th>9204</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 0, 0,...</td>\n","      <td>[2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","      <td>209</td>\n","    </tr>\n","    <tr>\n","      <th>9205</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>[2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","      <td>209</td>\n","    </tr>\n","    <tr>\n","      <th>9206</th>\n","      <td>من و علی سیرو سیاه را دوست داریم .</td>\n","      <td>[0, 0, 0, 0, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...</td>\n","      <td>[2, 2078, 331, 2547, 51019, 4910, 2049, 3584, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, ...</td>\n","      <td>209</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>9205 rows × 5 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-6830bd47-ef92-4e10-af97-156958116314')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-6830bd47-ef92-4e10-af97-156958116314 button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-6830bd47-ef92-4e10-af97-156958116314');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-ea64eb4b-ab5c-4b23-b481-1318e62a80db\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-ea64eb4b-ab5c-4b23-b481-1318e62a80db')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-ea64eb4b-ab5c-4b23-b481-1318e62a80db button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"tdwn","summary":"{\n  \"name\": \"tdwn\",\n  \"rows\": 9205,\n  \"fields\": [\n    {\n      \"column\": \"wrong_sentence\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 3434,\n        \"samples\": [\n          \"\\u0628\\u063a\\u0636\\u06cc \\u0648\\u0642\\u062a \\u0647\\u0627 \\u0631\\u0648\\u0632 \\u062c\\u0645\\u0639\\u0647 \\u0628\\u0627 \\u0647\\u0645\\u0633\\u0631\\u0645 \\u0628\\u0631\\u0627\\u06cc \\u06af\\u0631\\u062f\\u0634 \\u0648 \\u0632\\u06cc\\u0627\\u0631\\u062a \\u0645\\u06cc \\u0631\\u0648\\u06cc\\u0645 .\",\n          \"\\u062f\\u0631 \\u06af\\u0634\\u0648\\u0631 \\u0645\\u0627 \\u062e\\u06cc\\u0644\\u06cc \\u0627\\u0646\\u0648\\u0627\\u0621 \\u0645\\u0631\\u062f\\u0645 \\u062f\\u0627\\u0631\\u062f .\",\n          \"\\u062f\\u0646\\u062f\\u0627\\u0646 \\u0645\\u0633\\u0648\\u0627\\u06af \\u0628\\u0631\\u0627\\u06cc \\u0630\\u0646\\u062f\\u0627\\u0646 \\u0627\\u0633\\u062a\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"error_index\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"input_ids\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"attention_mask\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"error_index_length\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 209,\n        \"max\": 209,\n        \"num_unique_values\": 1,\n        \"samples\": [\n          209\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":31}]},{"cell_type":"code","source":[],"metadata":{"id":"qCNGIAkeVBBh","executionInfo":{"status":"ok","timestamp":1724528614900,"user_tz":-210,"elapsed":5,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":31,"outputs":[]},{"cell_type":"code","source":["tdwn['lengths_equal'] = tdwn.apply(lambda row: len(row['input_ids']) == len(row['attention_mask']), axis=1)\n","\n","# # Display the DataFrame with the comparison column\n","# print(tdwn[['input_ids', 'attention_mask', 'lengths_equal']])\n"],"metadata":{"id":"WKAN1YcZUwRN","executionInfo":{"status":"ok","timestamp":1724528614900,"user_tz":-210,"elapsed":5,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":32,"outputs":[]},{"cell_type":"code","source":["# all_true = tdwn['lengths_equal'].all()\n","# print(all_true)\n"],"metadata":{"id":"7vx6qyUcU-BW","executionInfo":{"status":"ok","timestamp":1724528614900,"user_tz":-210,"elapsed":5,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":33,"outputs":[]},{"cell_type":"code","source":["def string_to_list_of_numbers(s):\n","    return [int(digit) for digit in s]"],"metadata":{"id":"2V6OQmdOgvGg","executionInfo":{"status":"ok","timestamp":1724528614900,"user_tz":-210,"elapsed":5,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":34,"outputs":[]},{"cell_type":"code","source":["# Apply conversion\n","tdwn['error_index'] = tdwn['error_index'].apply(string_to_list_of_numbers)"],"metadata":{"id":"dJOrhlVSgyKG","executionInfo":{"status":"ok","timestamp":1724528615371,"user_tz":-210,"elapsed":475,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":35,"outputs":[]},{"cell_type":"code","source":["\n","# Flattening all lists in column 'A' into a single list\n","numbers_in_A = [num for sublist in tdwn['error_index']  for num in sublist]\n","\n","# Identifying unique (extinct) numbers\n","unique_numbers = list(set(numbers_in_A))\n","\n","print(\"Unique (extinct) numbers in column 'A':\")\n","print(unique_numbers)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4mnBqjrotp59","executionInfo":{"status":"ok","timestamp":1724528615372,"user_tz":-210,"elapsed":11,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}},"outputId":"675f157f-e77b-4c81-8b85-cd9a09e13bf7"},"execution_count":36,"outputs":[{"output_type":"stream","name":"stdout","text":["Unique (extinct) numbers in column 'A':\n","[0, 37, 38, 39, 40, 10, 12, 13, 50, 20, 24, 25, 26, 30, 31]\n"]}]},{"cell_type":"code","source":["# number_to_find = 49\n","\n","# # Find records that contain the number 32\n","# records_with_number = tdwn[tdwn['error_index'].apply(lambda x: number_to_find in x)]\n","\n","# print(\"Records that contain the number 41:\")\n","# print(records_with_number)"],"metadata":{"id":"RtedsD39uInB","executionInfo":{"status":"ok","timestamp":1724528615372,"user_tz":-210,"elapsed":9,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":37,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"XwmguYRK6mlH","executionInfo":{"status":"ok","timestamp":1724528615372,"user_tz":-210,"elapsed":8,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":37,"outputs":[]},{"cell_type":"code","source":["# Define the label mapping for 2 classes\n","original_mapping = {\n","    \"True\": 0,\n","    \"MainSigns_None\":10,\n","    \"MainSigns_Consonants\": 12,\n","    \"MainSigns_Vowels\": 13,\n","    \"DiacriticSigns_None\":20,\n","    \"DiacriticSigns_Tashdid\":24,\n","    \"DiacriticSigns_Madd\":25,\n","    \"DiacriticSigns_Tanwin\":26,\n","    \"Form_None\":30,\n","    \"Form_Boundary\":31,\n","    \"Form_AlifLam\":37,\n","    \"Form_Place\":38,\n","    \"Form_Dot\":39,\n","    \"Punctuation\":40,\n","    \"None\":50\n","\n","\n","}\n","\n","label_mapping = {\n","    \"True\": 0,\n","    \"MainSigns_None\": 1,\n","    \"MainSigns_Consonants\": 2,\n","    \"MainSigns_Vowels\": 3,\n","    \"DiacriticSigns_None\": 4,\n","    \"DiacriticSigns_Tashdid\": 5,\n","    \"DiacriticSigns_Madd\": 6,\n","    \"DiacriticSigns_Tanwin\": 7,\n","    \"Form_None\": 8,\n","    \"Form_Boundary\": 9,\n","    \"Form_AlifLam\": 10,\n","    \"Form_Place\": 11,\n","    \"Form_Dot\": 12,\n","    \"Punctuation\": 13,\n","    \"None\": 14\n","}\n","\n","num_labels =15"],"metadata":{"id":"xbl-IjYHebM_","executionInfo":{"status":"ok","timestamp":1724528615372,"user_tz":-210,"elapsed":8,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":38,"outputs":[]},{"cell_type":"code","source":["index_mapping = {old_index: label_mapping[label] for label, old_index in original_mapping.items() if label in label_mapping}"],"metadata":{"id":"giPa2fxZ6ffa","executionInfo":{"status":"ok","timestamp":1724528615372,"user_tz":-210,"elapsed":8,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":39,"outputs":[]},{"cell_type":"code","source":["# Print the index_mapping to verify\n","print(\"Index Mapping:\", index_mapping)\n","\n","# Update the ERROR INDEX column\n","tdwn['error_index'] = tdwn['error_index'].apply(lambda indices: [index_mapping.get(i, i) for i in indices])\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Jx0D739U83Nx","executionInfo":{"status":"ok","timestamp":1724528615372,"user_tz":-210,"elapsed":8,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}},"outputId":"1cb94714-6f2c-4c51-ff1d-026230df20f3"},"execution_count":40,"outputs":[{"output_type":"stream","name":"stdout","text":["Index Mapping: {0: 0, 10: 1, 12: 2, 13: 3, 20: 4, 24: 5, 25: 6, 26: 7, 30: 8, 31: 9, 37: 10, 38: 11, 39: 12, 40: 13, 50: 14}\n"]}]},{"cell_type":"code","source":["tdwn['error_index']"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":458},"id":"RkkAoaRw854o","executionInfo":{"status":"ok","timestamp":1724528615372,"user_tz":-210,"elapsed":7,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}},"outputId":"ed1ea6fc-4eac-4cdf-c05d-990c6d7246cd"},"execution_count":41,"outputs":[{"output_type":"execute_result","data":{"text/plain":["0       [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","1       [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 0, 0, ...\n","2       [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","3       [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 0, 0, ...\n","4       [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 0, 0, ...\n","                              ...                        \n","9202    [0, 0, 0, 0, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...\n","9203    [0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, ...\n","9204    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, ...\n","9205    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","9206    [0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...\n","Name: error_index, Length: 9205, dtype: object"],"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>error_index</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>9202</th>\n","      <td>[0, 0, 0, 0, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...</td>\n","    </tr>\n","    <tr>\n","      <th>9203</th>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>9204</th>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>9205</th>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","    <tr>\n","      <th>9206</th>\n","      <td>[0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>9205 rows × 1 columns</p>\n","</div><br><label><b>dtype:</b> object</label>"]},"metadata":{},"execution_count":41}]},{"cell_type":"code","source":["# tdwn['error_index'] = tdwn['error_index'].apply(lambda indices: [index_mapping.get(i, i) for i in indices])\n"],"metadata":{"id":"d3ooBXnk9KkC","executionInfo":{"status":"ok","timestamp":1724528615372,"user_tz":-210,"elapsed":6,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":42,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"EGJFbKqV9MR9","executionInfo":{"status":"ok","timestamp":1724528615372,"user_tz":-210,"elapsed":6,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":42,"outputs":[]},{"cell_type":"code","source":["tdwn"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":771},"id":"FAl99XWW8VOh","executionInfo":{"status":"ok","timestamp":1724528615372,"user_tz":-210,"elapsed":6,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}},"outputId":"7aef5167-0f11-4dd7-884e-2314349ce4a8"},"execution_count":43,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                         wrong_sentence  \\\n","0     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","1     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","2     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","3     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","4     افغانستان موضوع : اسراف اسراف را خدا دوست ندار...   \n","...                                                 ...   \n","9202  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9203  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9204  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9205  ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...   \n","9206                 من و علی سیرو سیاه را دوست داریم .   \n","\n","                                            error_index  \\\n","0     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   \n","1     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 0, 0, ...   \n","2     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   \n","3     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 0, 0, ...   \n","4     [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 0, 0, ...   \n","...                                                 ...   \n","9202  [0, 0, 0, 0, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...   \n","9203  [0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, ...   \n","9204  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, ...   \n","9205  [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   \n","9206  [0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...   \n","\n","                                              input_ids  \\\n","0     [2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...   \n","1     [2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...   \n","2     [2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...   \n","3     [2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...   \n","4     [2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...   \n","...                                                 ...   \n","9202  [2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...   \n","9203  [2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...   \n","9204  [2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...   \n","9205  [2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...   \n","9206  [2, 2078, 331, 2547, 51019, 4910, 2049, 3584, ...   \n","\n","                                         attention_mask  error_index_length  \\\n","0     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...                 209   \n","1     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...                 209   \n","2     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...                 209   \n","3     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...                 209   \n","4     [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...                 209   \n","...                                                 ...                 ...   \n","9202  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...                 209   \n","9203  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...                 209   \n","9204  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...                 209   \n","9205  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...                 209   \n","9206  [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, ...                 209   \n","\n","      lengths_equal  \n","0              True  \n","1              True  \n","2              True  \n","3              True  \n","4              True  \n","...             ...  \n","9202           True  \n","9203           True  \n","9204           True  \n","9205           True  \n","9206           True  \n","\n","[9205 rows x 6 columns]"],"text/html":["\n","  <div id=\"df-1a6cf408-501b-4da0-98d8-37151da2ea8d\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>wrong_sentence</th>\n","      <th>error_index</th>\n","      <th>input_ids</th>\n","      <th>attention_mask</th>\n","      <th>error_index_length</th>\n","      <th>lengths_equal</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>[2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","      <td>209</td>\n","      <td>True</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 0, 0, ...</td>\n","      <td>[2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","      <td>209</td>\n","      <td>True</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>[2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","      <td>209</td>\n","      <td>True</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 9, 0, 0, ...</td>\n","      <td>[2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","      <td>209</td>\n","      <td>True</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>افغانستان موضوع : اسراف اسراف را خدا دوست ندار...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 0, 0, ...</td>\n","      <td>[2, 4981, 2534, 17, 18876, 18876, 2049, 3592, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","      <td>209</td>\n","      <td>True</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>9202</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,...</td>\n","      <td>[2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","      <td>209</td>\n","      <td>True</td>\n","    </tr>\n","    <tr>\n","      <th>9203</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>[2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","      <td>209</td>\n","      <td>True</td>\n","    </tr>\n","    <tr>\n","      <th>9204</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, ...</td>\n","      <td>[2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","      <td>209</td>\n","      <td>True</td>\n","    </tr>\n","    <tr>\n","      <th>9205</th>\n","      <td>ماه بهار تولد مادرم هست ما به باغ گلا می رویم ...</td>\n","      <td>[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>[2, 2306, 5416, 6991, 11043, 2209, 2179, 2031,...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...</td>\n","      <td>209</td>\n","      <td>True</td>\n","    </tr>\n","    <tr>\n","      <th>9206</th>\n","      <td>من و علی سیرو سیاه را دوست داریم .</td>\n","      <td>[0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...</td>\n","      <td>[2, 2078, 331, 2547, 51019, 4910, 2049, 3584, ...</td>\n","      <td>[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, ...</td>\n","      <td>209</td>\n","      <td>True</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>9205 rows × 6 columns</p>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-1a6cf408-501b-4da0-98d8-37151da2ea8d')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-1a6cf408-501b-4da0-98d8-37151da2ea8d button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-1a6cf408-501b-4da0-98d8-37151da2ea8d');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-16e1b08e-1e21-4762-8b3a-65dbda1298eb\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-16e1b08e-1e21-4762-8b3a-65dbda1298eb')\"\n","            title=\"Suggest charts\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","      --bg-color: #E8F0FE;\n","      --fill-color: #1967D2;\n","      --hover-bg-color: #E2EBFA;\n","      --hover-fill-color: #174EA6;\n","      --disabled-fill-color: #AAA;\n","      --disabled-bg-color: #DDD;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","      --bg-color: #3B4455;\n","      --fill-color: #D2E3FC;\n","      --hover-bg-color: #434B5C;\n","      --hover-fill-color: #FFFFFF;\n","      --disabled-bg-color: #3B4455;\n","      --disabled-fill-color: #666;\n","  }\n","\n","  .colab-df-quickchart {\n","    background-color: var(--bg-color);\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: var(--fill-color);\n","    height: 32px;\n","    padding: 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: var(--hover-bg-color);\n","    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: var(--button-hover-fill-color);\n","  }\n","\n","  .colab-df-quickchart-complete:disabled,\n","  .colab-df-quickchart-complete:disabled:hover {\n","    background-color: var(--disabled-bg-color);\n","    fill: var(--disabled-fill-color);\n","    box-shadow: none;\n","  }\n","\n","  .colab-df-spinner {\n","    border: 2px solid var(--fill-color);\n","    border-color: transparent;\n","    border-bottom-color: var(--fill-color);\n","    animation:\n","      spin 1s steps(1) infinite;\n","  }\n","\n","  @keyframes spin {\n","    0% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","      border-left-color: var(--fill-color);\n","    }\n","    20% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    30% {\n","      border-color: transparent;\n","      border-left-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","      border-right-color: var(--fill-color);\n","    }\n","    40% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-top-color: var(--fill-color);\n","    }\n","    60% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","    }\n","    80% {\n","      border-color: transparent;\n","      border-right-color: var(--fill-color);\n","      border-bottom-color: var(--fill-color);\n","    }\n","    90% {\n","      border-color: transparent;\n","      border-bottom-color: var(--fill-color);\n","    }\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const quickchartButtonEl =\n","        document.querySelector('#' + key + ' button');\n","      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n","      quickchartButtonEl.classList.add('colab-df-spinner');\n","      try {\n","        const charts = await google.colab.kernel.invokeFunction(\n","            'suggestCharts', [key], {});\n","      } catch (error) {\n","        console.error('Error during call to suggestCharts:', error);\n","      }\n","      quickchartButtonEl.classList.remove('colab-df-spinner');\n","      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-16e1b08e-1e21-4762-8b3a-65dbda1298eb button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"],"application/vnd.google.colaboratory.intrinsic+json":{"type":"dataframe","variable_name":"tdwn","summary":"{\n  \"name\": \"tdwn\",\n  \"rows\": 9205,\n  \"fields\": [\n    {\n      \"column\": \"wrong_sentence\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 3434,\n        \"samples\": [\n          \"\\u0628\\u063a\\u0636\\u06cc \\u0648\\u0642\\u062a \\u0647\\u0627 \\u0631\\u0648\\u0632 \\u062c\\u0645\\u0639\\u0647 \\u0628\\u0627 \\u0647\\u0645\\u0633\\u0631\\u0645 \\u0628\\u0631\\u0627\\u06cc \\u06af\\u0631\\u062f\\u0634 \\u0648 \\u0632\\u06cc\\u0627\\u0631\\u062a \\u0645\\u06cc \\u0631\\u0648\\u06cc\\u0645 .\",\n          \"\\u062f\\u0631 \\u06af\\u0634\\u0648\\u0631 \\u0645\\u0627 \\u062e\\u06cc\\u0644\\u06cc \\u0627\\u0646\\u0648\\u0627\\u0621 \\u0645\\u0631\\u062f\\u0645 \\u062f\\u0627\\u0631\\u062f .\",\n          \"\\u062f\\u0646\\u062f\\u0627\\u0646 \\u0645\\u0633\\u0648\\u0627\\u06af \\u0628\\u0631\\u0627\\u06cc \\u0630\\u0646\\u062f\\u0627\\u0646 \\u0627\\u0633\\u062a\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"error_index\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"input_ids\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"attention_mask\",\n      \"properties\": {\n        \"dtype\": \"object\",\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"error_index_length\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 209,\n        \"max\": 209,\n        \"num_unique_values\": 1,\n        \"samples\": [\n          209\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"lengths_equal\",\n      \"properties\": {\n        \"dtype\": \"boolean\",\n        \"num_unique_values\": 1,\n        \"samples\": [\n          true\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"}},"metadata":{},"execution_count":43}]},{"cell_type":"markdown","source":[],"metadata":{"id":"bIO2Wn7E8VCw"}},{"cell_type":"code","source":[],"metadata":{"id":"yHrCJEiW8EnC","executionInfo":{"status":"ok","timestamp":1724528615372,"user_tz":-210,"elapsed":6,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":43,"outputs":[]},{"cell_type":"code","source":["data = {\n","    'input_ids': tdwn['input_ids'],\n","    'attention_mask': tdwn['attention_mask'],\n","    'labels': tdwn['error_index'],\n","}"],"metadata":{"id":"kpTyszmnSwR6","executionInfo":{"status":"ok","timestamp":1724528615965,"user_tz":-210,"elapsed":598,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":44,"outputs":[]},{"cell_type":"code","source":["dataset = Dataset.from_dict(data)"],"metadata":{"id":"dMLo9yg2Wty5","executionInfo":{"status":"ok","timestamp":1724528616595,"user_tz":-210,"elapsed":632,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":45,"outputs":[]},{"cell_type":"code","source":["train_test_split = dataset.train_test_split(test_size=0.2)\n","train_dataset = train_test_split['train']\n","test_dataset = train_test_split['test']"],"metadata":{"id":"pLyhGybDbMTi","executionInfo":{"status":"ok","timestamp":1724528616595,"user_tz":-210,"elapsed":4,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":46,"outputs":[]},{"cell_type":"code","source":["def format_labels(examples):\n","    return {'labels': [torch.tensor(label, dtype=torch.long) for label in examples['labels']]}\n","\n","train_dataset = train_dataset.map(format_labels, batched=True)\n","test_dataset = test_dataset.map(format_labels, batched=True)\n","\n","# Set the format to torch tensors\n","train_dataset.set_format(type='torch', columns=['input_ids', 'attention_mask', 'labels'])\n","test_dataset.set_format(type='torch', columns=['input_ids', 'attention_mask', 'labels'])\n","\n","\n","\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":81,"referenced_widgets":["5ed0d1e08db4433c8bd8978c216baf02","cad78858fbe64bff87bb785d393fca56","36c25e5569144fe9a5f49ad4ceafb433","4d1114e6c89547a59bd710913698ced5","62a75cac82b64f838888425140d497ec","c63de1333cdd499182198a1401950aa8","5a06b7d3f5444ab1a5df0f7aade4db60","c04be9594c9f45bfaf6fd9e1c34c01f6","aca3ab17d5c549bdb86b659bdd7c782f","a6b282ed454a4a79b06c3ba37366c034","15c1b3f1dbaa4733a4ac88e25a39fb70","b640deb1f6804f408222b7058a335fc2","d5ba0b2e62de40f69f5f077df78ea413","927577ed307f451e8fff0a8e92974ec1","81a2d1d4393744b0beab04fdd5dbd181","6bc01794b7924e1186f5842759928914","87a84f46da38432c942623f26decf1df","0db4b5898a5649959a03ec7846c14fd5","3792d3e605da40ac9758d8c160fa5618","5123b539c37c4a939da2cc427cf70cfb","8a6a7517ed8541efb0fb00e61089d227","f57c0dc75a7a47d8a2eea445026ca507"]},"id":"DU0H7c4bbYrL","executionInfo":{"status":"ok","timestamp":1724528618300,"user_tz":-210,"elapsed":1708,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}},"outputId":"4920e8a5-439c-4ed3-ceba-d557d1057fec"},"execution_count":47,"outputs":[{"output_type":"display_data","data":{"text/plain":["Map:   0%|          | 0/7364 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"5ed0d1e08db4433c8bd8978c216baf02"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Map:   0%|          | 0/1841 [00:00<?, ? examples/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"b640deb1f6804f408222b7058a335fc2"}},"metadata":{}}]},{"cell_type":"code","source":["from transformers import BertForTokenClassification, Trainer, TrainingArguments, BertTokenizer\n","\n","# Load ParsBERT pretrained model and tokenizer\n","model_name = \"HooshvareLab/bert-fa-base-uncased\"  # Replace with the exact ParsBERT model name\n","tokenizer = BertTokenizer.from_pretrained(model_name)\n","model = BertForTokenClassification.from_pretrained(model_name, num_labels=num_labels)\n","\n","# Ensure that your labels are aligned with the model\n","# Create the label2id mapping\n","model.config.label2id = {v: k for k, v in label_mapping.items()}\n","\n","# Optional: Create id2label mapping (if you need the reverse mapping)\n","model.config.id2label = {k: v for k, v in label_mapping.items()}"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":169,"referenced_widgets":["ff3297f7d80b4c1d9b8171db00bb9618","64db82acf1384537adcfe8fa88a068b1","6c8710e0ca684fe09c8abe105f2580d1","390a83a19d4049889fa9ef6b14a2ba8d","b7ac055189de4e4597a48e1e9ce05928","0ce1bfa870c94aaa936429a03a686f36","23896c05e551402787edc58408944ec7","929ba9d50885422abfbaba6d4d25f515","33ae02d2ce4d47fea6331a759dc7fad7","453e7ed86a7741ccb9e03df27a1ff0df","558f6842f6674266aa02466847c543b2","ec961aeddcf74cccb2fd4bebed3c4461","8ba81eddf5f5457089ba8464ecabe2cd","213a9aa14e344381aa79d55bd7070073","51ec8d3021bd44d6ae5405a7542c75b9","b843bb51c24f4a7db26ec22071e22c11","434d9bf3988840e5987b7ddf154e0184","ddc8e330126c4eaeb7fa0da98e1ca791","872922a065b04533b50ab831115ba69d","ea240d251bb3453690418383a1700202","86c20147735a400e8b94013092cf5b5f","3590db4cae0f4172abb3a8190c3e02d2","ea1ecff259344a05adbc2970c2173155","1f37dbe3137a4c408b74de9ae88b4790","d30e2f47071440babeb903188d35b6eb","eb1eca4c2ec94bd3890b225816134bdb","9b5a2d891ffe43fbaa924b3cb7f8deb1","0adac590d313459683350d147cd49247","7b1670505f594c13bec269b4a59ca254","d8bcd300b0834dff97d22b6400137dc7","bfae00d27285496d8389da9649b55e22","e0f65beeab7640a2a0d765e135ea60a5","45e41c89b2bc428185d239456c4bd4b7"]},"id":"Y53xO3MxeA8i","executionInfo":{"status":"ok","timestamp":1724528629893,"user_tz":-210,"elapsed":11595,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}},"outputId":"0cb5e238-4a6e-4023-ec34-669651b6cf45"},"execution_count":48,"outputs":[{"output_type":"display_data","data":{"text/plain":["vocab.txt:   0%|          | 0.00/1.20M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"ff3297f7d80b4c1d9b8171db00bb9618"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["config.json:   0%|          | 0.00/440 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"ec961aeddcf74cccb2fd4bebed3c4461"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["pytorch_model.bin:   0%|          | 0.00/654M [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"ea1ecff259344a05adbc2970c2173155"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["Some weights of BertForTokenClassification were not initialized from the model checkpoint at HooshvareLab/bert-fa-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"]}]},{"cell_type":"code","source":["from transformers import TrainingArguments\n","\n","training_args = TrainingArguments(\n","    output_dir='./results',          # Output directory\n","    num_train_epochs=20,              # Number of training epochs\n","    per_device_train_batch_size=8,   # Batch size for training\n","    per_device_eval_batch_size=8,    # Batch size for evaluation (if needed)\n","    warmup_steps=500,                # Number of warmup steps for learning rate scheduler\n","    weight_decay=0.01,               # Strength of weight decay\n","    logging_dir='./logs',            # Directory for storing logs\n","    logging_steps=100,                # Log every 10 steps\n","    eval_strategy=\"steps\",           # Change this to \"eval_strategy\"\n","    # save_steps=500,                  # Save checkpoint every 500 steps\n","    save_total_limit=3,              # Limit the total amount of checkpoints\n","    learning_rate=2e-5,              # Learning rate\n",")\n","\n","trainer = Trainer(\n","    model=model,\n","    args=training_args,\n","    train_dataset=train_dataset,\n","    eval_dataset=test_dataset,\n",")"],"metadata":{"id":"4_D-zdXYfA1j","executionInfo":{"status":"ok","timestamp":1724528633117,"user_tz":-210,"elapsed":3,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":51,"outputs":[]},{"cell_type":"code","source":["trainer.train()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"ChL1S9x_fTDo","outputId":"b7f44e76-ee22-49d4-b9cc-114dcd563ad0","executionInfo":{"status":"error","timestamp":1724528631391,"user_tz":-210,"elapsed":837,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":50,"outputs":[{"output_type":"stream","name":"stderr","text":["ERROR:root:Internal Python error in the inspect module.\n","Below is the traceback from this internal error.\n","\n"]},{"output_type":"stream","name":"stdout","text":["Traceback (most recent call last):\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\", line 3553, in run_code\n","    exec(code_obj, self.user_global_ns, self.user_ns)\n","  File \"<ipython-input-50-3435b262f1ae>\", line 1, in <cell line: 1>\n","    trainer.train()\n","  File \"/usr/local/lib/python3.10/dist-packages/transformers/trainer.py\", line 1932, in train\n","    return inner_training_loop(\n","  File \"/usr/local/lib/python3.10/dist-packages/transformers/trainer.py\", line 2033, in _inner_training_loop\n","    self.create_optimizer_and_scheduler(num_training_steps=max_steps)\n","  File \"/usr/local/lib/python3.10/dist-packages/transformers/trainer.py\", line 1031, in create_optimizer_and_scheduler\n","    self.create_optimizer()\n","  File \"/usr/local/lib/python3.10/dist-packages/transformers/trainer.py\", line 1093, in create_optimizer\n","    self.optimizer = optimizer_cls(optimizer_grouped_parameters, **optimizer_kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/optim/adamw.py\", line 53, in __init__\n","    super().__init__(params, defaults)\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/optim/optimizer.py\", line 284, in __init__\n","    self.add_param_group(cast(dict, param_group))\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/_compile.py\", line 22, in inner\n","    import torch._dynamo\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/_dynamo/__init__.py\", line 2, in <module>\n","    from . import convert_frame, eval_frame, resume_execution\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/_dynamo/convert_frame.py\", line 40, in <module>\n","    from . import config, exc, trace_rules\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/_dynamo/trace_rules.py\", line 50, in <module>\n","    from .variables import (\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/_dynamo/variables/__init__.py\", line 3, in <module>\n","    from .base import VariableTracker\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/_dynamo/variables/base.py\", line 10, in <module>\n","    from ..source import AttrSource, Source\n","  File \"/usr/local/lib/python3.10/dist-packages/torch/_dynamo/source.py\", line 324, in <module>\n","    class GetItemSource(ChainedSource):\n","  File \"/usr/lib/python3.10/dataclasses.py\", line 1175, in wrap\n","    return _process_class(cls, init, repr, eq, order, unsafe_hash,\n","  File \"/usr/lib/python3.10/dataclasses.py\", line 1075, in _process_class\n","    for fn in _frozen_get_del_attr(cls, field_list, globals):\n","  File \"/usr/lib/python3.10/dataclasses.py\", line 606, in _frozen_get_del_attr\n","    return (_create_fn('__setattr__',\n","  File \"/usr/lib/python3.10/dataclasses.py\", line 432, in _create_fn\n","    exec(txt, globals, ns)\n","  File \"<string>\", line 1, in <module>\n","KeyboardInterrupt\n","\n","During handling of the above exception, another exception occurred:\n","\n","Traceback (most recent call last):\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\", line 2099, in showtraceback\n","    stb = value._render_traceback_()\n","AttributeError: 'KeyboardInterrupt' object has no attribute '_render_traceback_'\n","\n","During handling of the above exception, another exception occurred:\n","\n","Traceback (most recent call last):\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 1101, in get_records\n","    return _fixed_getinnerframes(etb, number_of_lines_of_context, tb_offset)\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 248, in wrapped\n","    return f(*args, **kwargs)\n","  File \"/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\", line 281, in _fixed_getinnerframes\n","    records = fix_frame_records_filenames(inspect.getinnerframes(etb, context))\n","  File \"/usr/lib/python3.10/inspect.py\", line 1662, in getinnerframes\n","    frameinfo = (tb.tb_frame,) + getframeinfo(tb, context)\n","  File \"/usr/lib/python3.10/inspect.py\", line 1620, in getframeinfo\n","    filename = getsourcefile(frame) or getfile(frame)\n","  File \"/usr/lib/python3.10/inspect.py\", line 829, in getsourcefile\n","    module = getmodule(object, filename)\n","  File \"/usr/lib/python3.10/inspect.py\", line 875, in getmodule\n","    f = getabsfile(module)\n","  File \"/usr/lib/python3.10/inspect.py\", line 845, in getabsfile\n","    return os.path.normcase(os.path.abspath(_filename))\n","  File \"/usr/lib/python3.10/posixpath.py\", line 380, in abspath\n","    if not isabs(path):\n","  File \"/usr/lib/python3.10/posixpath.py\", line 62, in isabs\n","    s = os.fspath(s)\n","KeyboardInterrupt\n"]},{"output_type":"error","ename":"TypeError","evalue":"object of type 'NoneType' has no len()","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)","    \u001b[0;31m[... skipping hidden 1 frame]\u001b[0m\n","\u001b[0;32m<ipython-input-50-3435b262f1ae>\u001b[0m in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mtrainer\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtrain\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/trainer.py\u001b[0m in \u001b[0;36mtrain\u001b[0;34m(self, resume_from_checkpoint, trial, ignore_keys_for_eval, **kwargs)\u001b[0m\n\u001b[1;32m   1931\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1932\u001b[0;31m             return inner_training_loop(\n\u001b[0m\u001b[1;32m   1933\u001b[0m                 \u001b[0margs\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/trainer.py\u001b[0m in \u001b[0;36m_inner_training_loop\u001b[0;34m(self, batch_size, args, resume_from_checkpoint, trial, ignore_keys_for_eval)\u001b[0m\n\u001b[1;32m   2032\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mdelay_optimizer_creation\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2033\u001b[0;31m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcreate_optimizer_and_scheduler\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mnum_training_steps\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mmax_steps\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   2034\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/trainer.py\u001b[0m in \u001b[0;36mcreate_optimizer_and_scheduler\u001b[0;34m(self, num_training_steps)\u001b[0m\n\u001b[1;32m   1030\u001b[0m         \"\"\"\n\u001b[0;32m-> 1031\u001b[0;31m         \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcreate_optimizer\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1032\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mIS_SAGEMAKER_MP_POST_1_10\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0msmp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mstate\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mcfg\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mfp16\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/transformers/trainer.py\u001b[0m in \u001b[0;36mcreate_optimizer\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   1092\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1093\u001b[0;31m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0moptimizer\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0moptimizer_cls\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0moptimizer_grouped_parameters\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0moptimizer_kwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1094\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/optim/adamw.py\u001b[0m in \u001b[0;36m__init__\u001b[0;34m(self, params, lr, betas, eps, weight_decay, amsgrad, maximize, foreach, capturable, differentiable, fused)\u001b[0m\n\u001b[1;32m     52\u001b[0m         )\n\u001b[0;32m---> 53\u001b[0;31m         \u001b[0msuper\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__init__\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mparams\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mdefaults\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     54\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/optim/optimizer.py\u001b[0m in \u001b[0;36m__init__\u001b[0;34m(self, params, defaults)\u001b[0m\n\u001b[1;32m    283\u001b[0m         \u001b[0;32mfor\u001b[0m \u001b[0mparam_group\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mparam_groups\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 284\u001b[0;31m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0madd_param_group\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcast\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdict\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mparam_group\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    285\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/_compile.py\u001b[0m in \u001b[0;36minner\u001b[0;34m(*args, **kwargs)\u001b[0m\n\u001b[1;32m     21\u001b[0m         \u001b[0;32mdef\u001b[0m \u001b[0minner\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0margs\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 22\u001b[0;31m             \u001b[0;32mimport\u001b[0m \u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_dynamo\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     23\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/_dynamo/__init__.py\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mtorch\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 2\u001b[0;31m \u001b[0;32mfrom\u001b[0m \u001b[0;34m.\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mconvert_frame\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0meval_frame\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mresume_execution\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      3\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0;34m.\u001b[0m\u001b[0mbackends\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mregistry\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mlist_backends\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlookup_backend\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mregister_backend\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/_dynamo/convert_frame.py\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m     39\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 40\u001b[0;31m \u001b[0;32mfrom\u001b[0m \u001b[0;34m.\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mconfig\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mexc\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtrace_rules\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     41\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0;34m.\u001b[0m\u001b[0mbackends\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mregistry\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mCompilerFn\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/_dynamo/trace_rules.py\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m     49\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 50\u001b[0;31m from .variables import (\n\u001b[0m\u001b[1;32m     51\u001b[0m     \u001b[0mBuiltinVariable\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/_dynamo/variables/__init__.py\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 3\u001b[0;31m \u001b[0;32mfrom\u001b[0m \u001b[0;34m.\u001b[0m\u001b[0mbase\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mVariableTracker\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      4\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0;34m.\u001b[0m\u001b[0mbuiltin\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mBuiltinVariable\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/_dynamo/variables/base.py\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m      9\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0;34m.\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mexc\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0munimplemented\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 10\u001b[0;31m \u001b[0;32mfrom\u001b[0m \u001b[0;34m.\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0msource\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mAttrSource\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mSource\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     11\u001b[0m \u001b[0;32mfrom\u001b[0m \u001b[0;34m.\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mutils\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0midentity\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mistype\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/_dynamo/source.py\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n\u001b[1;32m    323\u001b[0m \u001b[0;34m@\u001b[0m\u001b[0mdataclasses\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdataclass\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mfrozen\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;32mTrue\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 324\u001b[0;31m \u001b[0;32mclass\u001b[0m \u001b[0mGetItemSource\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mChainedSource\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    325\u001b[0m     \u001b[0mindex\u001b[0m\u001b[0;34m:\u001b[0m \u001b[0mAny\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/lib/python3.10/dataclasses.py\u001b[0m in \u001b[0;36mwrap\u001b[0;34m(cls)\u001b[0m\n\u001b[1;32m   1174\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mwrap\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcls\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1175\u001b[0;31m         return _process_class(cls, init, repr, eq, order, unsafe_hash,\n\u001b[0m\u001b[1;32m   1176\u001b[0m                               frozen, match_args, kw_only, slots)\n","\u001b[0;32m/usr/lib/python3.10/dataclasses.py\u001b[0m in \u001b[0;36m_process_class\u001b[0;34m(cls, init, repr, eq, order, unsafe_hash, frozen, match_args, kw_only, slots)\u001b[0m\n\u001b[1;32m   1074\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0mfrozen\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1075\u001b[0;31m         \u001b[0;32mfor\u001b[0m \u001b[0mfn\u001b[0m \u001b[0;32min\u001b[0m \u001b[0m_frozen_get_del_attr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcls\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfield_list\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mglobals\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1076\u001b[0m             \u001b[0;32mif\u001b[0m \u001b[0m_set_new_attribute\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mcls\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfn\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__name__\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mfn\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/lib/python3.10/dataclasses.py\u001b[0m in \u001b[0;36m_frozen_get_del_attr\u001b[0;34m(cls, fields, globals)\u001b[0m\n\u001b[1;32m    605\u001b[0m         \u001b[0mfields_str\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m'()'\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 606\u001b[0;31m     return (_create_fn('__setattr__',\n\u001b[0m\u001b[1;32m    607\u001b[0m                       \u001b[0;34m(\u001b[0m\u001b[0;34m'self'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'name'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m'value'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/lib/python3.10/dataclasses.py\u001b[0m in \u001b[0;36m_create_fn\u001b[0;34m(name, args, body, globals, locals, return_type)\u001b[0m\n\u001b[1;32m    431\u001b[0m     \u001b[0mns\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0;34m{\u001b[0m\u001b[0;34m}\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 432\u001b[0;31m     \u001b[0mexec\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtxt\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mglobals\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mns\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    433\u001b[0m     \u001b[0;32mreturn\u001b[0m \u001b[0mns\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0;34m'__create_fn__'\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m**\u001b[0m\u001b[0mlocals\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/torch/_dynamo/source.py\u001b[0m in \u001b[0;36m<module>\u001b[0;34m\u001b[0m\n","\u001b[0;31mKeyboardInterrupt\u001b[0m: ","\nDuring handling of the above exception, another exception occurred:\n","\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\u001b[0m in \u001b[0;36mshowtraceback\u001b[0;34m(self, exc_tuple, filename, tb_offset, exception_only, running_compiled_code)\u001b[0m\n\u001b[1;32m   2098\u001b[0m                         \u001b[0;31m# in the engines. This should return a list of strings.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2099\u001b[0;31m                         \u001b[0mstb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mvalue\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_render_traceback_\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   2100\u001b[0m                     \u001b[0;32mexcept\u001b[0m \u001b[0mException\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mAttributeError\u001b[0m: 'KeyboardInterrupt' object has no attribute '_render_traceback_'","\nDuring handling of the above exception, another exception occurred:\n","\u001b[0;31mTypeError\u001b[0m                                 Traceback (most recent call last)","    \u001b[0;31m[... skipping hidden 1 frame]\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/IPython/core/interactiveshell.py\u001b[0m in \u001b[0;36mshowtraceback\u001b[0;34m(self, exc_tuple, filename, tb_offset, exception_only, running_compiled_code)\u001b[0m\n\u001b[1;32m   2099\u001b[0m                         \u001b[0mstb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mvalue\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_render_traceback_\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   2100\u001b[0m                     \u001b[0;32mexcept\u001b[0m \u001b[0mException\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 2101\u001b[0;31m                         stb = self.InteractiveTB.structured_traceback(etype,\n\u001b[0m\u001b[1;32m   2102\u001b[0m                                             value, tb, tb_offset=tb_offset)\n\u001b[1;32m   2103\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\u001b[0m in \u001b[0;36mstructured_traceback\u001b[0;34m(self, etype, value, tb, tb_offset, number_of_lines_of_context)\u001b[0m\n\u001b[1;32m   1365\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1366\u001b[0m             \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mtb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtb\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1367\u001b[0;31m         return FormattedTB.structured_traceback(\n\u001b[0m\u001b[1;32m   1368\u001b[0m             self, etype, value, tb, tb_offset, number_of_lines_of_context)\n\u001b[1;32m   1369\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\u001b[0m in \u001b[0;36mstructured_traceback\u001b[0;34m(self, etype, value, tb, tb_offset, number_of_lines_of_context)\u001b[0m\n\u001b[1;32m   1265\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0mmode\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mverbose_modes\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1266\u001b[0m             \u001b[0;31m# Verbose modes need a full traceback\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1267\u001b[0;31m             return VerboseTB.structured_traceback(\n\u001b[0m\u001b[1;32m   1268\u001b[0m                 \u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0metype\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mvalue\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtb\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtb_offset\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mnumber_of_lines_of_context\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1269\u001b[0m             )\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\u001b[0m in \u001b[0;36mstructured_traceback\u001b[0;34m(self, etype, evalue, etb, tb_offset, number_of_lines_of_context)\u001b[0m\n\u001b[1;32m   1122\u001b[0m         \u001b[0;34m\"\"\"Return a nice text document describing the traceback.\"\"\"\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1123\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1124\u001b[0;31m         formatted_exception = self.format_exception_as_a_whole(etype, evalue, etb, number_of_lines_of_context,\n\u001b[0m\u001b[1;32m   1125\u001b[0m                                                                tb_offset)\n\u001b[1;32m   1126\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\u001b[0m in \u001b[0;36mformat_exception_as_a_whole\u001b[0;34m(self, etype, evalue, etb, number_of_lines_of_context, tb_offset)\u001b[0m\n\u001b[1;32m   1080\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1081\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1082\u001b[0;31m         \u001b[0mlast_unique\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mrecursion_repeat\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mfind_recursion\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0morig_etype\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mevalue\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mrecords\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1083\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1084\u001b[0m         \u001b[0mframes\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mformat_records\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mrecords\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlast_unique\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mrecursion_repeat\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.10/dist-packages/IPython/core/ultratb.py\u001b[0m in \u001b[0;36mfind_recursion\u001b[0;34m(etype, value, records)\u001b[0m\n\u001b[1;32m    380\u001b[0m     \u001b[0;31m# first frame (from in to out) that looks different.\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    381\u001b[0m     \u001b[0;32mif\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mis_recursion_error\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0metype\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mvalue\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mrecords\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 382\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mrecords\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m0\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    383\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    384\u001b[0m     \u001b[0;31m# Select filename, lineno, func_name to track frames with\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mTypeError\u001b[0m: object of type 'NoneType' has no len()"]}]},{"cell_type":"code","source":["model.save_pretrained('content/drive/Mydrive/Error_detection /model')\n"],"metadata":{"id":"hctQGyYFxD33","executionInfo":{"status":"aborted","timestamp":1724528631393,"user_tz":-210,"elapsed":7,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["# Correct `id2label` mapping\n","model.config.id2label = {\n","    0: \"True\",\n","    1: \"MainSigns_None\",\n","    2: \"MainSigns_Consonants\",\n","    3: \"MainSigns_Vowels\",\n","    4: \"DiacriticSigns_None\",\n","    5: \"DiacriticSigns_Tashdid\",\n","    6: \"DiacriticSigns_Madd\",\n","    7: \"DiacriticSigns_Tanwin\",\n","    8: \"Form_None\",\n","    9: \"Form_Boundary\",\n","    10: \"Form_AlifLam\",\n","    11: \"Form_Place\",\n","    12: \"Form_Dot\",\n","    13: \"Punctuation\",\n","    14: \"None\"\n","}\n","\n","# Correct `label2id` mapping\n","model.config.label2id = {\n","    \"True\": 0,\n","    \"MainSigns_None\": 1,\n","    \"MainSigns_Consonants\": 2,\n","    \"MainSigns_Vowels\": 3,\n","    \"DiacriticSigns_None\": 4,\n","    \"DiacriticSigns_Tashdid\": 5,\n","    \"DiacriticSigns_Madd\": 6,\n","    \"DiacriticSigns_Tanwin\": 7,\n","    \"Form_None\": 8,\n","    \"Form_Boundary\": 9,\n","    \"Form_AlifLam\": 10,\n","    \"Form_Place\": 11,\n","    \"Form_Dot\": 12,\n","    \"Punctuation\": 13,\n","    \"None\": 14\n","}\n"],"metadata":{"id":"fdgUwi_8fJPT","executionInfo":{"status":"aborted","timestamp":1724528631393,"user_tz":-210,"elapsed":6,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from transformers import AutoTokenizer, AutoModelForTokenClassification\n","import torch\n","\n","# # Load the trained model and tokenizer\n","# model_path = \"path_to_your_trained_model\"  # Change to the path of your saved model\n","# tokenizer_path = \"path_to_your_tokenizer\"  # Change to the path of your saved tokenizer\n","\n","# tokenizer = AutoTokenizer.from_pretrained(tokenizer_path)\n","# model = AutoModelForTokenClassification.from_pretrained(model_path)\n","\n","# # Move model to GPU if available\n","# device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n","# model.to(device)\n","\n","# # Input text\n","text = \"توضیه کلاس است\"\n","\n","# # Tokenize the input text\n","inputs = tokenizer(text, return_tensors=\"pt\", is_split_into_words=False, padding=True, truncation=True)\n","input_ids = inputs[\"input_ids\"].to(device)\n","attention_mask = inputs[\"attention_mask\"].to(device)\n","\n","# # Get predictions from the model\n","model.eval()  # Set the model to evaluation mode\n","with torch.no_grad():\n","    outputs = model(input_ids=input_ids, attention_mask=attention_mask)\n","    logits = outputs.logits\n","\n","# # Convert logits to predicted labels\n","predictions = torch.argmax(logits, dim=2)\n","\n","# # Map label IDs to actual labels\n","id2label = model.config.id2label\n","predicted_labels = []\n","for label_id in predictions[0]:\n","    label_id = label_id.item()\n","    predicted_labels.append(id2label.get(label_id, \"Unknown Label\"))\n","\n","# # Post-process the predictions\n","tokens = tokenizer.convert_ids_to_tokens(input_ids[0])\n","print(\"Tokens:\", tokens)\n","print(\"Predicted Labels:\", predicted_labels)\n","for i in range(0,len(predicted_labels)):\n","  if predicted_labels[i]==\"LABEL_1\":\n","    print(\"error is in this word :\",tokens[i])"],"metadata":{"id":"5tOgW7ekbVP3","executionInfo":{"status":"aborted","timestamp":1724528631393,"user_tz":-210,"elapsed":6,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["test_loader = DataLoader(test_dataset, sampler=SequentialSampler(test_dataset), batch_size=16)\n"],"metadata":{"id":"Cy1rAaHPyRyj","executionInfo":{"status":"aborted","timestamp":1724528631393,"user_tz":-210,"elapsed":6,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["model.eval()  # Set the model to evaluation mode\n","\n","all_preds = []\n","all_labels = []\n","\n","with torch.no_grad():\n","    for batch in tqdm(test_loader, desc=\"Evaluating\"):\n","        input_ids = batch['input_ids'].to(device)\n","        attention_mask = batch['attention_mask'].to(device)\n","        labels = batch['labels'].to(device)  # Assuming your dataset has labels\n","\n","        outputs = model(input_ids=input_ids, attention_mask=attention_mask)\n","        logits = outputs.logits\n","\n","        # Get the predictions\n","        preds = torch.argmax(logits, dim=-1)\n","\n","        all_preds.extend(preds.cpu().numpy().flatten())\n","        all_labels.extend(labels.cpu().numpy().flatten())\n","\n","# Calculate accuracy\n","accuracy = accuracy_score(all_labels, all_preds)\n","\n","print(f\"Accuracy: {accuracy:.4f}\")"],"metadata":{"id":"fYz1UHoBBbv2","executionInfo":{"status":"aborted","timestamp":1724528631393,"user_tz":-210,"elapsed":6,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":null,"outputs":[]},{"cell_type":"code","source":[],"metadata":{"id":"J5zxIFSuy3H1","executionInfo":{"status":"aborted","timestamp":1724528631393,"user_tz":-210,"elapsed":6,"user":{"displayName":"Morvarid Rahbar","userId":"18132147507361826385"}}},"execution_count":null,"outputs":[]}]}